#!/bin/bash

# =============================================
# ğŸŸ£ PURPLEHOST PANEL - AUTOMATYCZNA INSTALACJA
# =============================================

# Konfiguracja
PANEL_DIR="/home/purplehost"
WEB_DIR="$PANEL_DIR/web"
SERVER_DIR="$PANEL_DIR/serwery"
PORT=8080
LOG_DIR="$PANEL_DIR/logs"

# Kolory
PURPLE='\033[0;35m'
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
CYAN='\033[0;36m'
NC='\033[0m'

# =============================================
# ğŸ› ï¸ FUNKCJE POMOCNICZE
# =============================================

log() {
    echo -e "${PURPLE}[$(date '+%Y-%m-%d %H:%M:%S')]${NC} $1"
    echo "$(date '+%Y-%m-%d %H:%M:%S') - $1" >> "$LOG_DIR/panel.log"
}

error() {
    echo -e "${RED}[BÅÄ„D]${NC} $1"
    echo "$(date '+%Y-%m-%d %H:%M:%S') - BÅÄ„D: $1" >> "$LOG_DIR/errors.log"
}

setup_directories() {
    echo -e "${PURPLE}ğŸ“ Tworzenie struktur katalogÃ³w...${NC}"
    mkdir -p "$PANEL_DIR" "$WEB_DIR" "$SERVER_DIR" "$LOG_DIR"
    mkdir -p "$SERVER_DIR/minecraft" "$SERVER_DIR/rust" "$SERVER_DIR/ark" "$SERVER_DIR/csgo" "$SERVER_DIR/teamspeak"
    log "Katalogi PurpleHost utworzone"
}

check_dependencies() {
    echo -e "${PURPLE}ğŸ” Sprawdzanie zaleÅ¼noÅ›ci...${NC}"
    
    local deps=("python3" "wget" "curl" "unzip" "tar" "java")
    local missing=()
    
    for dep in "${deps[@]}"; do
        if ! command -v "$dep" &> /dev/null; then
            missing+=("$dep")
        fi
    done
    
    if [ ${#missing[@]} -gt 0 ]; then
        echo -e "${YELLOW}ğŸ“¦ Instalowanie brakujÄ…cych zaleÅ¼noÅ›ci...${NC}"
        apt update > /dev/null 2>&1
        
        for dep in "${missing[@]}"; do
            case $dep in
                "java")
                    echo -e "${CYAN}â˜• Instalowanie Java...${NC}"
                    apt install -y default-jre > /dev/null 2>&1
                    ;;
                *)
                    echo -e "${CYAN}ğŸ“¦ Instalowanie $dep...${NC}"
                    apt install -y "$dep" > /dev/null 2>&1
                    ;;
            esac
            echo -e "${GREEN}âœ… Zainstalowano: $dep${NC}"
        done
    fi
    
    echo -e "${GREEN}âœ… Wszystkie zaleÅ¼noÅ›ci sÄ… dostÄ™pne${NC}"
}

# =============================================
# ğŸŒ TWORZENIE PANELU WEB
# =============================================

create_web_panel() {
    echo -e "${PURPLE}ğŸŒ Tworzenie panelu PurpleHost...${NC}"
    
    # UtwÃ³rz gÅ‚Ã³wnÄ… stronÄ™
    cat > "$WEB_DIR/index.html" << 'HTML'
<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸŸ£ PurpleHost - Professional Hosting</title>
    <style>
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body { 
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            padding: 15px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }
        
        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #6a11cb;
        }
        
        .nav-menu {
            display: flex;
            list-style: none;
            gap: 30px;
        }
        
        .nav-menu a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            padding: 8px 16px;
            border-radius: 5px;
            transition: all 0.3s ease;
        }
        
        .nav-menu a:hover {
            background: #6a11cb;
            color: white;
        }
        
        .container {
            max-width: 1200px;
            margin: 30px auto;
            padding: 0 20px;
        }
        
        .welcome-banner {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .welcome-banner h1 {
            color: #6a11cb;
            margin-bottom: 15px;
            font-size: 2.5em;
        }
        
        .warning-banner {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            color: #856404;
        }
        
        .main-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            margin-top: 20px;
        }
        
        .server-panel {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .side-panel {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .panel-title {
            color: #6a11cb;
            margin-bottom: 20px;
            font-size: 1.5em;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
        }
        
        .server-list {
            list-style: none;
            margin-bottom: 25px;
        }
        
        .server-item {
            padding: 15px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }
        
        .server-item:hover {
            border-color: #6a11cb;
            box-shadow: 0 2px 8px rgba(106, 17, 203, 0.1);
        }
        
        .server-info h4 {
            color: #333;
            margin-bottom: 5px;
        }
        
        .server-status {
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: bold;
        }
        
        .status-online {
            background: #d4edda;
            color: #155724;
        }
        
        .status-offline {
            background: #f8d7da;
            color: #721c24;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }
        
        .btn-primary {
            background: #6a11cb;
            color: white;
        }
        
        .btn-primary:hover {
            background: #5a0db3;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-success:hover {
            background: #218838;
        }
        
        .btn-danger {
            background: #dc3545;
            color: white;
        }
        
        .create-server-form {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-top: 20px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #555;
        }
        
        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        
        .info-box {
            background: #e3f2fd;
            border: 1px solid #90caf9;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: white;
            font-size: 0.9em;
        }
        
        .server-actions {
            display: flex;
            gap: 8px;
        }
        
        .btn-sm {
            padding: 6px 12px;
            font-size: 0.85em;
        }
        
        .success-message {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="nav-container">
            <div class="logo">ğŸŸ£ PurpleHost</div>
            <ul class="nav-menu">
                <li><a href="#" onclick="showSection('konto')">A. Konto</a></li>
                <li><a href="#" onclick="showSection('sklep')">B. Sklep</a></li>
                <li><a href="#" onclick="showSection('plasnokki')">C. Plasnokki</a></li>
                <li><a href="#" onclick="showSection('senway')">D. Senway</a></li>
            </ul>
        </div>
    </div>

    <div class="container">
        <div class="welcome-banner">
            <h1>ğŸŸ£ PurpleHost Panel</h1>
            <p>Profesjonalny hosting serwerÃ³w gry - Panel zostaÅ‚ pomyÅ›lnie uruchomiony!</p>
            <div class="success-message">
                <strong>âœ… System gotowy do pracy!</strong><br>
                Panel zostaÅ‚ automatycznie utworzony i uruchomiony.
            </div>
        </div>

        <div class="warning-banner">
            âš ï¸ <strong>Warning out...</strong> Not this convention postupancy is a twoism location.
        </div>

        <div class="main-grid">
            <!-- GÅ‚Ã³wny panel -->
            <div class="server-panel">
                <h2 class="panel-title">ğŸ® ZarzÄ…dzanie Serwerami</h2>
                
                <div class="info-box">
                    <h4>ğŸš€ Szybki Start</h4>
                    <p>UtwÃ³rz swÃ³j pierwszy serwer gry w kilku prostych krokach. Wybierz typ serwera, konfiguracjÄ™ i uruchom!</p>
                </div>

                <ul class="server-list" id="serverList">
                    <li class="server-item">
                        <div class="server-info">
                            <h4>ğŸ¯ Brak serwerÃ³w</h4>
                            <p>UtwÃ³rz pierwszy serwer aby rozpoczÄ…Ä‡</p>
                        </div>
                        <div style="text-align: right;">
                            <div class="server-status status-offline">
                                ğŸ”´ OFFLINE
                            </div>
                        </div>
                    </li>
                </ul>

                <button class="btn btn-primary" onclick="showCreateServerForm()">â• UtwÃ³rz Nowy Serwer</button>

                <!-- Formularz tworzenia serwera -->
                <div class="create-server-form" id="createServerForm" style="display: none;">
                    <h3 style="margin-bottom: 20px; color: #6a11cb;">ğŸ› ï¸ Tworzenie Serwera</h3>
                    
                    <div class="form-group">
                        <label for="serverName">Nazwa Serwera</label>
                        <input type="text" class="form-control" id="serverName" placeholder="WprowadÅº nazwÄ™ serwera">
                    </div>
                    
                    <div class="form-group">
                        <label for="serverType">Typ Serwera</label>
                        <select class="form-control" id="serverType">
                            <option value="minecraft">Minecraft</option>
                            <option value="teamspeak">TeamSpeak 3</option>
                            <option value="csgo">Counter-Strike: GO</option>
                            <option value="rust">Rust</option>
                            <option value="ark">ARK: Survival Evolved</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="serverSlots">Liczba slotÃ³w</label>
                        <select class="form-control" id="serverSlots">
                            <option value="10">10 slotÃ³w</option>
                            <option value="20">20 slotÃ³w</option>
                            <option value="30">30 slotÃ³w</option>
                            <option value="50">50 slotÃ³w</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="serverVersion">Wersja</label>
                        <input type="text" class="form-control" id="serverVersion" placeholder="Najnowsza wersja" value="Najnowsza">
                    </div>
                    
                    <div style="display: flex; gap: 10px; margin-top: 20px;">
                        <button class="btn btn-success" onclick="createServer()">ğŸš€ UtwÃ³rz Serwer</button>
                        <button class="btn btn-danger" onclick="hideCreateServerForm()">âŒ Anuluj</button>
                    </div>
                </div>
            </div>

            <!-- Panel boczny -->
            <div class="side-panel">
                <h3 class="panel-title">ğŸ“Š Status Systemu</h3>
                
                <div class="info-box">
                    <h4>ğŸŸ¢ Status Panelu</h4>
                    <p>System dziaÅ‚a poprawnie</p>
                    <p><strong>Port:</strong> 8080</p>
                    <p><strong>Wersja:</strong> 1.0</p>
                </div>
                
                <div class="info-box">
                    <h4>ğŸ’¾ Zasoby</h4>
                    <p>Serwery: <strong>0</strong></p>
                    <p>Online: <strong>0</strong></p>
                    <p>Wolne porty: <strong>DostÄ™pne</strong></p>
                </div>
                
                <div class="info-box">
                    <h4>ğŸ“ˆ Informacje</h4>
                    <p>â€¢ Minecraft: Port 25565</p>
                    <p>â€¢ TeamSpeak: Port 9987</p>
                    <p>â€¢ CS:GO: Port 27015</p>
                    <p>â€¢ Wsparcie Java</p>
                </div>
                
                <button class="btn btn-primary" style="width: 100%; margin-top: 15px;" onclick="refreshStats()">
                    ğŸ”„ OdÅ›wieÅ¼
                </button>
            </div>
        </div>
    </div>

    <div class="footer">
        Copyright Â© 2025 purpleHost.ru
    </div>

    <script>
        function showSection(section) {
            const sections = {
                'konto': 'Panel zarzÄ…dzania kontem i ustawieniami',
                'sklep': 'Zakup dodatkowych usÅ‚ug i zasobÃ³w',
                'plasnokki': 'ZarzÄ…dzanie serwerami i usÅ‚ugami',
                'senway': 'Monitorowanie i statystyki systemu'
            };
            alert('Przechodzisz do: ' + (sections[section] || section));
        }
        
        function showCreateServerForm() {
            document.getElementById('createServerForm').style.display = 'block';
        }
        
        function hideCreateServerForm() {
            document.getElementById('createServerForm').style.display = 'none';
            document.getElementById('serverName').value = '';
        }
        
        function createServer() {
            const name = document.getElementById('serverName').value;
            const type = document.getElementById('serverType').value;
            const slots = document.getElementById('serverSlots').value;
            const version = document.getElementById('serverVersion').value;
            
            if (!name) {
                alert('ProszÄ™ wprowadziÄ‡ nazwÄ™ serwera!');
                return;
            }
            
            // Symulacja tworzenia serwera
            const serverList = document.getElementById('serverList');
            serverList.innerHTML = '';
            
            const newServer = document.createElement('li');
            newServer.className = 'server-item';
            newServer.innerHTML = `
                <div class="server-info">
                    <h4>${getServerIcon(type)} ${name}</h4>
                    <p>Typ: ${type} | Sloty: ${slots} | Wersja: ${version}</p>
                    <small>Utworzono: ${new Date().toLocaleString()}</small>
                </div>
                <div style="text-align: right;">
                    <div class="server-status status-offline">
                        ğŸ”´ OFFLINE
                    </div>
                    <div class="server-actions" style="margin-top: 8px;">
                        <button class="btn btn-success btn-sm" onclick="startServer(this)">â–¶ Start</button>
                        <button class="btn btn-danger btn-sm" onclick="deleteServer(this)">ğŸ—‘ï¸</button>
                    </div>
                </div>
            `;
            
            serverList.appendChild(newServer);
            hideCreateServerForm();
            
            alert('âœ… Serwer "' + name + '" zostaÅ‚ utworzony pomyÅ›lnie!');
        }
        
        function getServerIcon(type) {
            const icons = {
                'minecraft': 'â›ï¸',
                'rust': 'ğŸ¦€',
                'ark': 'ğŸ¦–',
                'csgo': 'ğŸ”«',
                'teamspeak': 'ğŸ§'
            };
            return icons[type] || 'ğŸ–¥ï¸';
        }
        
        function startServer(button) {
            const serverItem = button.closest('.server-item');
            const statusDiv = serverItem.querySelector('.server-status');
            statusDiv.className = 'server-status status-online';
            statusDiv.innerHTML = 'ğŸŸ¢ ONLINE';
            button.textContent = 'â¹ Stop';
            button.onclick = function() { stopServer(this); };
            
            alert('ğŸŸ¢ Serwer uruchomiony pomyÅ›lnie!');
        }
        
        function stopServer(button) {
            const serverItem = button.closest('.server-item');
            const statusDiv = serverItem.querySelector('.server-status');
            statusDiv.className = 'server-status status-offline';
            statusDiv.innerHTML = 'ğŸ”´ OFFLINE';
            button.textContent = 'â–¶ Start';
            button.onclick = function() { startServer(this); };
            
            alert('ğŸ”´ Serwer zatrzymany!');
        }
        
        function deleteServer(button) {
            if (confirm('Czy na pewno chcesz usunÄ…Ä‡ ten serwer?')) {
                const serverItem = button.closest('.server-item');
                serverItem.remove();
                
                // JeÅ›li nie ma serwerÃ³w, pokaÅ¼ domyÅ›lny komunikat
                const serverList = document.getElementById('serverList');
                if (serverList.children.length === 0) {
                    serverList.innerHTML = `
                        <li class="server-item">
                            <div class="server-info">
                                <h4>ğŸ¯ Brak serwerÃ³w</h4>
                                <p>UtwÃ³rz pierwszy serwer aby rozpoczÄ…Ä‡</p>
                            </div>
                            <div style="text-align: right;">
                                <div class="server-status status-offline">
                                    ğŸ”´ OFFLINE
                                </div>
                            </div>
                        </li>
                    `;
                }
                
                alert('ğŸ—‘ï¸ Serwer usuniÄ™ty!');
            }
        }
        
        function refreshStats() {
            alert('ğŸ“Š Statystyki odÅ›wieÅ¼one! System dziaÅ‚a poprawnie.');
        }
        
        // Pokazuj informacje o uruchomieniu
        console.log('ğŸŸ£ PurpleHost Panel zostaÅ‚ uruchomiony pomyÅ›lnie!');
        console.log('ğŸŒ Adres: http://localhost:8080');
        console.log('ğŸ“ Katalog: /home/purplehost/web');
    </script>
</body>
</html>
HTML

    # UtwÃ³rz stronÄ™ statusu
    cat > "$WEB_DIR/status.html" << 'STATUS'
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Status - PurpleHost</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Arial', sans-serif; 
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            min-height: 100vh; 
            color: #333;
            padding: 20px;
        }
        .container { 
            max-width: 800px; 
            margin: 50px auto; 
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .header { 
            text-align: center; 
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #eee;
        }
        .header h1 { 
            font-size: 2.5em; 
            color: #6a11cb;
            margin-bottom: 10px;
        }
        .status-grid {
            display: grid;
            gap: 15px;
            margin: 25px 0;
        }
        .status-item {
            padding: 20px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .status-online { 
            background: #d4edda; 
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status-offline { 
            background: #f8d7da; 
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .status-icon {
            font-size: 2em;
        }
        .status-info h3 {
            margin-bottom: 5px;
        }
        .btn {
            display: inline-block;
            padding: 12px 25px;
            background: #6a11cb;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-weight: bold;
            margin-top: 20px;
            transition: all 0.3s ease;
        }
        .btn:hover {
            background: #5a0db3;
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“Š Status Systemu</h1>
            <p>PurpleHost - Professional Hosting</p>
        </div>

        <div class="status-grid">
            <div class="status-item status-online">
                <div class="status-icon">ğŸŒ</div>
                <div class="status-info">
                    <h3>Serwer Web</h3>
                    <p><strong>Status:</strong> DZIAÅA â€¢ <strong>Port:</strong> 8080</p>
                </div>
            </div>
            
            <div class="status-item status-online">
                <div class="status-icon">ğŸŸ£</div>
                <div class="status-info">
                    <h3>Panel PurpleHost</h3>
                    <p><strong>Status:</strong> AKTYWNY â€¢ <strong>Wersja:</strong> 1.0</p>
                </div>
            </div>
            
            <div class="status-item status-online">
                <div class="status-icon">ğŸ“</div>
                <div class="status-info">
                    <h3>System PlikÃ³w</h3>
                    <p><strong>Status:</strong> DOSTÄ˜PNY â€¢ <strong>Katalog:</strong> /home/purplehost</p>
                </div>
            </div>
            
            <div class="status-item status-online">
                <div class="status-icon">âš¡</div>
                <div class="status-info">
                    <h3>WydajnoÅ›Ä‡</h3>
                    <p><strong>Status:</strong> OPTYMALNA â€¢ <strong>Czas dziaÅ‚ania:</strong> <span id="uptime">0:00:00</span></p>
                </div>
            </div>
        </div>

        <div style="text-align: center;">
            <a href="/" class="btn">â† PowrÃ³t do Panelu GÅ‚Ã³wnego</a>
        </div>
    </div>

    <script>
        // Aktualizuj czas dziaÅ‚ania
        function updateUptime() {
            const startTime = new Date();
            setInterval(() => {
                const now = new Date();
                const diff = Math.floor((now - startTime) / 1000);
                const hours = Math.floor(diff / 3600);
                const minutes = Math.floor((diff % 3600) / 60);
                const seconds = diff % 60;
                
                document.getElementById('uptime').textContent = 
                    `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }
        
        updateUptime();
    </script>
</body>
</html>
STATUS

    echo -e "${GREEN}âœ… Panel PurpleHost zostaÅ‚ utworzony!${NC}"
    echo -e "${PURPLE}ğŸ“ Lokalizacja: $WEB_DIR/${NC}"
}

start_web_server() {
    echo -e "${PURPLE}ğŸŒ Uruchamianie serwera PurpleHost...${NC}"
    
    # SprawdÅº czy port jest dostÄ™pny
    if lsof -Pi :$PORT -sTCP:LISTEN -t >/dev/null ; then
        echo -e "${YELLOW}ğŸ”„ Port $PORT jest zajÄ™ty, zatrzymywanie istniejÄ…cego serwera...${NC}"
        pkill -f "python3 -m http.server $PORT"
        sleep 2
    fi
    
    # Uruchom serwer HTTP
    cd "$WEB_DIR"
    python3 -m http.server $PORT > /dev/null 2>&1 &
    local web_pid=$!
    
    sleep 2
    
    if ps -p $web_pid > /dev/null 2>&1; then
        local ip=$(hostname -I | awk '{print $1}')
        
        echo -e "${GREEN}âœ… Serwer PurpleHost uruchomiony pomyÅ›lnie!${NC}"
        echo -e "${PURPLE}"
        echo -e "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
        echo -e "â•‘                ğŸŸ£ PURPLEHOST                    â•‘"
        echo -e "â•‘           Panel zostaÅ‚ uruchomiony!             â•‘"
        echo -e "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
        echo -e "â•‘                                                  â•‘"
        echo -e "â•‘  ğŸŒ Adresy dostÄ™pu:                              â•‘"
        echo -e "â•‘     ğŸ“ Local:    http://localhost:$PORT         â•‘"
        echo -e "â•‘     ğŸŒ SieÄ‡:     http://$ip:$PORT               â•‘"
        echo -e "â•‘     ğŸ“Š Status:   http://localhost:$PORT/status  â•‘"
        echo -e "â•‘                                                  â•‘"
        echo -e "â•‘  ğŸ“ Katalog panelu: $WEB_DIR                    â•‘"
        echo -e "â•‘  ğŸ® Katalog serwerÃ³w: $SERVER_DIR               â•‘"
        echo -e "â•‘                                                  â•‘"
        echo -e "â•‘  ğŸ’¡ OtwÃ³rz przeglÄ…darkÄ™ i wejdÅº na powyÅ¼szy     â•‘"
        echo -e "â•‘     adres aby korzystaÄ‡ z panelu                â•‘"
        echo -e "â•‘                                                  â•‘"
        echo -e "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
        echo -e "${NC}"
        
        # OtwÃ³rz przeglÄ…darkÄ™ jeÅ›li jest graficzne Å›rodowisko
        if [ -n "$DISPLAY" ]; then
            echo -e "${YELLOW}ğŸ–¥ï¸  Otwieranie przeglÄ…darki...${NC}"
            xdg-open "http://localhost:$PORT" 2>/dev/null &
        fi
        
        # Zapisz PID serwera
        echo $web_pid > "$PANEL_DIR/web_server.pid"
        log "Serwer web uruchomiony (PID: $web_pid)"
        
    else
        error "âŒ Nie udaÅ‚o siÄ™ uruchomiÄ‡ serwera web!"
        exit 1
    fi
}

show_success_message() {
    echo -e "${GREEN}"
    echo -e "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo -e "â•‘                ğŸ‰ INSTALACJA ZAKOÅƒCZONA!        â•‘"
    echo -e "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
    echo -e "â•‘                                                  â•‘"
    echo -e "â•‘  Panel PurpleHost zostaÅ‚ utworzony i uruchomiony â•‘"
    echo -e "â•‘  automatycznie!                                  â•‘"
    echo -e "â•‘                                                  â•‘"
    echo -e "â•‘  MoÅ¼esz teraz:                                   â•‘"
    echo -e "â•‘    â€¢ OtworzyÄ‡ przeglÄ…darkÄ™                       â•‘"
    echo -e "â•‘    â€¢ WejÅ›Ä‡ na http://localhost:8080              â•‘"
    echo -e "â•‘    â€¢ ZarzÄ…dzaÄ‡ serwerami gry                     â•‘"
    echo -e "â•‘                                                  â•‘"
    echo -e "â•‘  Panel bÄ™dzie dziaÅ‚aÅ‚ do momentu zamkniÄ™cia      â•‘"
    echo -e "â•‘  terminala lub rÄ™cznego zatrzymania.             â•‘"
    echo -e "â•‘                                                  â•‘"
    echo -e "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo -e "${NC}"
}

# =============================================
# ğŸ“œ MAIN SCRIPT - AUTOMATYCZNA INSTALACJA
# =============================================

clear

echo -e "${PURPLE}"
echo -e "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo -e "â•‘        ğŸŸ£ PURPLEHOST PANEL           â•‘"
echo -e "â•‘      Automatyczna Instalacja         â•‘"
echo -e "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo -e "${NC}"
echo -e "${CYAN}Rozpoczynanie automatycznej instalacji...${NC}"
echo ""

# Inicjalizacja
echo -e "${PURPLE}ğŸš€ Inicjalizacja systemu...${NC}"
setup_directories
check_dependencies

# Tworzenie panelu
echo -e "${PURPLE}ğŸ“ Tworzenie panelu web...${NC}"
create_web_panel

# Uruchamianie serwera
echo -e "${PURPLE}ğŸŒ Uruchamianie serwera...${NC}"
start_web_server

# Komunikat sukcesu
show_success_message

# Informacja o zatrzymaniu
echo -e "${YELLOW}ğŸ“ Aby zatrzymaÄ‡ panel, naciÅ›nij Ctrl+C lub zamknij terminal.${NC}"
echo ""

# Czekaj na sygnaÅ‚ zakoÅ„czenia
trap 'echo -e "\n${GREEN}ğŸ‘‹ Zamykanie PurpleHost Panel...${NC}"; pkill -f "python3 -m http.server $PORT"; exit 0' INT TERM

# Bezczynne czekanie, aby skrypt siÄ™ nie zakoÅ„czyÅ‚
while true; do
    sleep 60
done
