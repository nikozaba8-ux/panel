#!/bin/bash

# =============================================
# üü£ PURPLEHOST PANEL - PRAWDZIWE SERWERY
# =============================================

# Konfiguracja
PANEL_DIR="/home/purplehost"
WEB_DIR="$PANEL_DIR/web"
SERVER_DIR="$PANEL_DIR/serwery"
PORT=8080
LOG_DIR="$PANEL_DIR/logs"

# Kolory
PURPLE='\033[0;35m'
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
CYAN='\033[0;36m'
NC='\033[0m'

# =============================================
# üõ†Ô∏è FUNKCJE POMOCNICZE
# =============================================

log() {
    echo -e "${PURPLE}[$(date '+%Y-%m-%d %H:%M:%S')]${NC} $1"
    echo "$(date '+%Y-%m-%d %H:%M:%S') - $1" >> "$LOG_DIR/panel.log"
}

error() {
    echo -e "${RED}[B≈ÅƒÑD]${NC} $1"
    echo "$(date '+%Y-%m-%d %H:%M:%S') - B≈ÅƒÑD: $1" >> "$LOG_DIR/errors.log"
}

setup_directories() {
    mkdir -p "$PANEL_DIR" "$WEB_DIR" "$SERVER_DIR" "$LOG_DIR"
    mkdir -p "$SERVER_DIR/minecraft" "$SERVER_DIR/rust" "$SERVER_DIR/ark" "$SERVER_DIR/csgo" "$SERVER_DIR/teamspeak"
    log "Katalogi PurpleHost utworzone"
}

check_dependencies() {
    echo -e "${YELLOW}üîç Sprawdzanie zale≈ºno≈õci...${NC}"
    
    local deps=("python3" "wget" "curl" "unzip" "tar" "java")
    local missing=()
    
    for dep in "${deps[@]}"; do
        if ! command -v "$dep" &> /dev/null; then
            missing+=("$dep")
        fi
    done
    
    if [ ${#missing[@]} -gt 0 ]; then
        echo -e "${YELLOW}üì¶ Instalowanie brakujƒÖcych zale≈ºno≈õci...${NC}"
        apt update > /dev/null 2>&1
        
        for dep in "${missing[@]}"; do
            case $dep in
                "java")
                    apt install -y default-jre > /dev/null 2>&1
                    ;;
                *)
                    apt install -y "$dep" > /dev/null 2>&1
                    ;;
            esac
            echo -e "${GREEN}‚úÖ Zainstalowano: $dep${NC}"
        done
    fi
    
    echo -e "${GREEN}‚úÖ Wszystkie zale≈ºno≈õci sƒÖ dostƒôpne${NC}"
}

# =============================================
# üéÆ FUNKCJE SERWER√ìW GRY
# =============================================

download_minecraft_server() {
    local server_dir="$1"
    local version="$2"
    
    log "Pobieranie serwera Minecraft $version..."
    
    cd "$server_dir"
    
    if [ "$version" == "Najnowsza" ]; then
        # Pobierz najnowszƒÖ wersjƒô
        wget -q https://piston-data.mojang.com/v1/objects/8f3112a1049751cc472ec13e397eade5336ca7ae/server.jar -O server.jar
    else
        # Tutaj mo≈ºna dodaƒá pobieranie konkretnych wersji
        wget -q https://piston-data.mojang.com/v1/objects/8f3112a1049751cc472ec13e397eade5336ca7ae/server.jar -O server.jar
    fi
    
    # Utw√≥rz plik eula.txt
    echo "eula=true" > eula.txt
    
    # Podstawowa konfiguracja
    cat > server.properties << EOF
server-port=25565
online-mode=false
level-type=default
max-players=20
motd=Minecraft Server hosted by PurpleHost
EOF

    log "Serwer Minecraft pobrany do: $server_dir"
}

download_rust_server() {
    local server_dir="$1"
    
    log "Pobieranie serwera Rust..."
    
    cd "$server_dir"
    
    # Pobierz SteamCMD
    wget -q https://steamcdn-a.akamaihd.net/client/installer/steamcmd_linux.tar.gz
    tar -xzf steamcmd_linux.tar.gz
    
    # Utw√≥rz skrypt instalacyjny dla Rust
    cat > install_rust.txt << EOF
@ShutdownOnFailedCommand 1
@NoPromptForPassword 1
force_install_dir ./rust_server
app_update 258550 validate
quit
EOF

    log "Serwer Rust bƒôdzie pobrany przy pierwszym uruchomieniu (wymaga SteamCMD)"
}

create_teamspeak_server() {
    local server_dir="$1"
    local port="$2"
    
    log "Konfigurowanie serwera TeamSpeak na porcie $port..."
    
    cd "$server_dir"
    
    # Pobierz TeamSpeak server
    wget -q http://dl.4players.de/ts/releases/3.13.7/teamspeak3-server_linux_amd64-3.13.7.tar.bz2
    tar -xjf teamspeak3-server_linux_amd64-3.13.7.tar.bz2
    mv teamspeak3-server_linux_amd64/* .
    rm -rf teamspeak3-server_linux_amd64*
    
    # Utw√≥rz plik konfiguracyjny
    cat > ts3server.ini << EOF
machine_id=
default_voice_port=$port
voice_ip=0.0.0.0
licensepath=
filetransfer_port=30033
filetransfer_ip=0.0.0.0
query_port=10011
query_ip=0.0.0.0
query_ip_whitelist=query_ip_whitelist.txt
query_ip_blacklist=query_ip_blacklist.txt
dbplugin=ts3db_sqlite3
dbpluginparameter=
dbsqlpath=sql/
dbsqlcreatepath=create_sqlite/
logpath=logs
logquerycommands=1
dbclientkeepdays=30
logappend=0
EOF

    log "Serwer TeamSpeak skonfigurowany na porcie $port"
}

create_csgo_server() {
    local server_dir="$1"
    local port="$2"
    
    log "Konfigurowanie serwera CS:GO na porcie $port..."
    
    cd "$server_dir"
    
    # Utw√≥rz skrypt instalacyjny
    cat > install_csgo.sh << EOF
#!/bin/bash
./steamcmd.sh +login anonymous +force_install_dir ./csgo_server +app_update 740 validate +quit
EOF

    cat > start_csgo.sh << EOF
#!/bin/bash
./csgo_server/srcds_run -game csgo -console -usercon +game_type 0 +game_mode 1 +mapgroup mg_active +map de_dust2 +sv_setsteamaccount "" -net_port_try 1 -port $port
EOF

    chmod +x install_csgo.sh start_csgo.sh
    
    log "Skrypty CS:GO utworzone - wymagajƒÖ SteamCMD"
}

# Funkcja do uruchamiania serwer√≥w
start_minecraft_server() {
    local server_dir="$1"
    local server_id="$2"
    
    cd "$server_dir"
    
    if [ ! -f "server.jar" ]; then
        error "Plik server.jar nie istnieje w $server_dir"
        return 1
    fi
    
    # Sprawd≈∫ czy serwer ju≈º dzia≈Ça
    if [ -f "server.pid" ] && ps -p $(cat server.pid) > /dev/null 2>&1; then
        log "Serwer Minecraft ju≈º dzia≈Ça (PID: $(cat server.pid))"
        return 0
    fi
    
    # Uruchom serwer w tle
    java -Xmx1024M -Xms1024M -jar server.jar nogui > server.log 2>&1 &
    local pid=$!
    echo $pid > server.pid
    
    log "Serwer Minecraft uruchomiony (PID: $pid)"
    return 0
}

stop_minecraft_server() {
    local server_dir="$1"
    
    cd "$server_dir"
    
    if [ -f "server.pid" ]; then
        local pid=$(cat server.pid)
        if ps -p $pid > /dev/null 2>&1; then
            kill $pid
            log "Zatrzymano serwer Minecraft (PID: $pid)"
        fi
        rm -f server.pid
    else
        log "Serwer Minecraft nie by≈Ç uruchomiony lub brak pliku PID"
    fi
}

start_teamspeak_server() {
    local server_dir="$1"
    local server_id="$2"
    
    cd "$server_dir"
    
    if [ ! -f "ts3server_startscript.sh" ]; then
        error "Skrypt TeamSpeak nie istnieje w $server_dir"
        return 1
    fi
    
    # Sprawd≈∫ czy serwer ju≈º dzia≈Ça
    if [ -f "ts3server.pid" ] && ps -p $(cat ts3server.pid) > /dev/null 2>&1; then
        log "Serwer TeamSpeak ju≈º dzia≈Ça (PID: $(cat ts3server.pid))"
        return 0
    fi
    
    # Uruchom serwer w tle
    ./ts3server_startscript.sh start > ts3server.log 2>&1 &
    local pid=$!
    echo $pid > ts3server.pid
    
    log "Serwer TeamSpeak uruchomiony (PID: $pid)"
    return 0
}

stop_teamspeak_server() {
    local server_dir="$1"
    
    cd "$server_dir"
    
    if [ -f "ts3server.pid" ]; then
        local pid=$(cat ts3server.pid)
        if ps -p $pid > /dev/null 2>&1; then
            ./ts3server_startscript.sh stop
            log "Zatrzymano serwer TeamSpeak (PID: $pid)"
        fi
        rm -f ts3server.pid
    else
        log "Serwer TeamSpeak nie by≈Ç uruchomiony lub brak pliku PID"
    fi
}

# =============================================
# üåê TWORZENIE PANELU WEB Z PRAWDZIWYMI SERWERAMI
# =============================================

create_web_panel() {
    echo -e "${PURPLE}üåê TWORZENIE PANELU PURPLEHOST...${NC}"
    
    # Utw√≥rz g≈Ç√≥wnƒÖ stronƒô z backendem do zarzƒÖdzania serwerami
    cat > "$WEB_DIR/index.html" << 'HTML'
<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üü£ PurpleHost - Prawdziwe Serwery</title>
    <style>
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body { 
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            padding: 15px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }
        
        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #6a11cb;
        }
        
        .nav-menu {
            display: flex;
            list-style: none;
            gap: 30px;
        }
        
        .nav-menu a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            padding: 8px 16px;
            border-radius: 5px;
            transition: all 0.3s ease;
        }
        
        .nav-menu a:hover {
            background: #6a11cb;
            color: white;
        }
        
        .container {
            max-width: 1200px;
            margin: 30px auto;
            padding: 0 20px;
        }
        
        .warning-banner {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            color: #856404;
        }
        
        .main-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            margin-top: 20px;
        }
        
        .server-panel {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .side-panel {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .panel-title {
            color: #6a11cb;
            margin-bottom: 20px;
            font-size: 1.5em;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
        }
        
        .server-list {
            list-style: none;
            margin-bottom: 25px;
        }
        
        .server-item {
            padding: 15px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }
        
        .server-item:hover {
            border-color: #6a11cb;
            box-shadow: 0 2px 8px rgba(106, 17, 203, 0.1);
        }
        
        .server-info h4 {
            color: #333;
            margin-bottom: 5px;
        }
        
        .server-status {
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: bold;
        }
        
        .status-online {
            background: #d4edda;
            color: #155724;
        }
        
        .status-offline {
            background: #f8d7da;
            color: #721c24;
        }
        
        .status-starting {
            background: #fff3cd;
            color: #856404;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }
        
        .btn-primary {
            background: #6a11cb;
            color: white;
        }
        
        .btn-primary:hover {
            background: #5a0db3;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-success:hover {
            background: #218838;
        }
        
        .btn-danger {
            background: #dc3545;
            color: white;
        }
        
        .btn-warning {
            background: #ffc107;
            color: #212529;
        }
        
        .create-server-form {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-top: 20px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #555;
        }
        
        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        
        .form-control:focus {
            border-color: #6a11cb;
            outline: none;
            box-shadow: 0 0 0 2px rgba(106, 17, 203, 0.2);
        }
        
        .info-box {
            background: #e3f2fd;
            border: 1px solid #90caf9;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: white;
            font-size: 0.9em;
        }
        
        .server-actions {
            display: flex;
            gap: 8px;
        }
        
        .btn-sm {
            padding: 6px 12px;
            font-size: 0.85em;
        }
        
        .log-output {
            background: #1e1e1e;
            color: #00ff00;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
            margin-top: 10px;
            display: none;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #6a11cb;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="nav-container">
            <div class="logo">üü£ PurpleHost - Prawdziwe Serwery</div>
            <ul class="nav-menu">
                <li><a href="#" onclick="showSection('dashboard')">A. Konto</a></li>
                <li><a href="#" onclick="showSection('sklep')">B. Sklep</a></li>
                <li><a href="#" onclick="showSection('serwery')">C. Plasnokki</a></li>
                <li><a href="#" onclick="showSection('senway')">D. Senway</a></li>
            </ul>
        </div>
    </div>

    <div class="container">
        <div class="warning-banner">
            ‚ö†Ô∏è <strong>Warning out...</strong> Not this convention postupancy is a twoism location.
        </div>

        <div class="main-grid">
            <!-- G≈Ç√≥wny panel -->
            <div class="server-panel">
                <h2 class="panel-title">üéÆ Twoje Serwery</h2>
                
                <div id="loadingServers" class="loading"></div>
                
                <ul class="server-list" id="serverList">
                    <!-- Serwery bƒôdƒÖ dodawane dynamicznie -->
                </ul>

                <button class="btn btn-primary" onclick="showCreateServerForm()">‚ûï Utw√≥rz Nowy Serwer</button>

                <!-- Formularz tworzenia serwera -->
                <div class="create-server-form" id="createServerForm" style="display: none;">
                    <h3 style="margin-bottom: 20px; color: #6a11cb;">üõ†Ô∏è Tworzenie Prawdziwego Serwera</h3>
                    
                    <div class="form-group">
                        <label for="serverName">Nazwa Serwera</label>
                        <input type="text" class="form-control" id="serverName" placeholder="Wprowad≈∫ nazwƒô serwera">
                    </div>
                    
                    <div class="form-group">
                        <label for="serverType">Typ Serwera</label>
                        <select class="form-control" id="serverType" onchange="updatePortInfo()">
                            <option value="minecraft">Minecraft</option>
                            <option value="teamspeak">TeamSpeak 3</option>
                            <option value="rust">Rust (Wymaga SteamCMD)</option>
                            <option value="csgo">CS:GO (Wymaga SteamCMD)</option>
                            <option value="ark">ARK (Wymaga SteamCMD)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="serverSlots">Liczba slot√≥w</label>
                        <select class="form-control" id="serverSlots">
                            <option value="10">10 slot√≥w</option>
                            <option value="20">20 slot√≥w</option>
                            <option value="30">30 slot√≥w</option>
                            <option value="50">50 slot√≥w</option>
                            <option value="100">100 slot√≥w</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="serverVersion">Wersja</label>
                        <input type="text" class="form-control" id="serverVersion" placeholder="Najnowsza wersja" value="Najnowsza">
                    </div>
                    
                    <div class="form-group">
                        <label for="serverPort">Port (automatyczny)</label>
                        <input type="text" class="form-control" id="serverPort" readonly>
                    </div>
                    
                    <div id="serverInfo" class="info-box" style="display: none;">
                        <strong>Informacje:</strong> <span id="serverInfoText"></span>
                    </div>
                    
                    <div style="display: flex; gap: 10px; margin-top: 20px;">
                        <button class="btn btn-success" onclick="createRealServer()">üöÄ Utw√≥rz Prawdziwy Serwer</button>
                        <button class="btn btn-danger" onclick="hideCreateServerForm()">‚ùå Anuluj</button>
                    </div>
                    
                    <div id="createLog" class="log-output"></div>
                </div>
            </div>

            <!-- Panel boczny -->
            <div class="side-panel">
                <h3 class="panel-title">üìä Statystyki Systemu</h3>
                
                <div class="info-box">
                    <h4>üü¢ Status Systemu</h4>
                    <p>Prawdziwe serwery gry</p>
                </div>
                
                <div class="info-box">
                    <h4>üíæ Zasoby Systemowe</h4>
                    <p>Serwery: <strong id="totalServers">0</strong></p>
                    <p>Dzia≈ÇajƒÖce: <strong id="runningServers">0</strong></p>
                    <p>Porty: <strong id="usedPorts">0</strong></p>
                </div>
                
                <div class="info-box">
                    <h4>üìà Informacje</h4>
                    <p>‚Ä¢ Minecraft: Port 25565+</p>
                    <p>‚Ä¢ TeamSpeak: Port 9987+</p>
                    <p>‚Ä¢ Wymaga Java dla Minecraft</p>
                    <p>‚Ä¢ Wymaga SteamCMD dla Rust/CS:GO</p>
                </div>
                
                <button class="btn btn-primary" style="width: 100%; margin-top: 15px;" onclick="refreshAll()">
                    üîÑ Od≈õwie≈º Wszystko
                </button>
            </div>
        </div>
    </div>

    <div class="footer">
        Copyright ¬© 2025 purpleHost.ru - Prawdziwe Serwery Gry
    </div>

    <script>
        let servers = [];
        let nextPorts = {
            minecraft: 25565,
            teamspeak: 9987,
            rust: 28015,
            csgo: 27015,
            ark: 7777
        };
        
        // Funkcje do komunikacji z backendem
        async function apiCall(action, data = {}) {
            try {
                const response = await fetch('/api', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ action, ...data })
                });
                return await response.json();
            } catch (error) {
                console.error('API Error:', error);
                return { success: false, error: error.message };
            }
        }
        
        async function loadServers() {
            document.getElementById('loadingServers').style.display = 'inline-block';
            const result = await apiCall('get_servers');
            document.getElementById('loadingServers').style.display = 'none';
            
            if (result.success) {
                servers = result.servers || [];
                renderServers();
                updateStats();
            } else {
                alert('B≈ÇƒÖd ≈Çadowania serwer√≥w: ' + result.error);
            }
        }
        
        async function createRealServer() {
            const name = document.getElementById('serverName').value;
            const type = document.getElementById('serverType').value;
            const slots = document.getElementById('serverSlots').value;
            const version = document.getElementById('serverVersion').value;
            const port = document.getElementById('serverPort').value;
            
            if (!name) {
                alert('Proszƒô wprowadziƒá nazwƒô serwera!');
                return;
            }
            
            const logElement = document.getElementById('createLog');
            logElement.style.display = 'block';
            logElement.innerHTML = 'üü£ Rozpoczynanie tworzenia serwera...\n';
            
            const result = await apiCall('create_server', {
                name,
                type,
                slots,
                version,
                port
            });
            
            if (result.success) {
                logElement.innerHTML += '‚úÖ Serwer utworzony pomy≈õlnie!\n';
                logElement.innerHTML += `üìÅ Katalog: ${result.server_dir}\n`;
                logElement.innerHTML += `üåê Port: ${result.port}\n`;
                
                // Od≈õwie≈º listƒô serwer√≥w po chwili
                setTimeout(() => {
                    loadServers();
                    hideCreateServerForm();
                }, 2000);
            } else {
                logElement.innerHTML += `‚ùå B≈ÇƒÖd: ${result.error}\n`;
            }
        }
        
        async function startRealServer(serverId) {
            const server = servers.find(s => s.id === serverId);
            if (!server) return;
            
            // Zmie≈Ñ status na starting
            server.status = 'starting';
            renderServers();
            
            const result = await apiCall('start_server', { server_id: serverId });
            
            if (result.success) {
                server.status = 'online';
                server.pid = result.pid;
                alert('üü¢ Serwer uruchomiony! PID: ' + result.pid);
            } else {
                server.status = 'offline';
                alert('‚ùå B≈ÇƒÖd uruchamiania: ' + result.error);
            }
            
            renderServers();
            updateStats();
        }
        
        async function stopRealServer(serverId) {
            const server = servers.find(s => s.id === serverId);
            if (!server) return;
            
            const result = await apiCall('stop_server', { server_id: serverId });
            
            if (result.success) {
                server.status = 'offline';
                server.pid = null;
                alert('üî¥ Serwer zatrzymany!');
            } else {
                alert('‚ùå B≈ÇƒÖd zatrzymywania: ' + result.error);
            }
            
            renderServers();
            updateStats();
        }
        
        async function deleteRealServer(serverId) {
            if (!confirm('Czy na pewno chcesz USUNƒÑƒÜ ten serwer? Wszystkie dane zostanƒÖ utracone!')) {
                return;
            }
            
            const result = await apiCall('delete_server', { server_id: serverId });
            
            if (result.success) {
                alert('üóëÔ∏è Serwer usuniƒôty!');
                loadServers();
            } else {
                alert('‚ùå B≈ÇƒÖd usuwania: ' + result.error);
            }
        }
        
        function showSection(section) {
            alert('Przechodzisz do sekcji: ' + section.toUpperCase());
        }
        
        function showCreateServerForm() {
            document.getElementById('createServerForm').style.display = 'block';
            updatePortInfo();
        }
        
        function hideCreateServerForm() {
            document.getElementById('createServerForm').style.display = 'none';
            document.getElementById('createLog').style.display = 'none';
            document.getElementById('createLog').innerHTML = '';
            document.getElementById('serverName').value = '';
        }
        
        function updatePortInfo() {
            const type = document.getElementById('serverType').value;
            const portField = document.getElementById('serverPort');
            const infoBox = document.getElementById('serverInfo');
            const infoText = document.getElementById('serverInfoText');
            
            // Znajd≈∫ nastƒôpny wolny port dla tego typu
            let nextPort = nextPorts[type];
            
            // Sprawd≈∫ kt√≥ry port jest faktycznie wolny
            servers.forEach(server => {
                if (server.type === type && server.port >= nextPort) {
                    nextPort = server.port + 1;
                }
            });
            
            portField.value = nextPort;
            
            // Ustaw informacje o serwerze
            const info = {
                minecraft: 'Wymaga Java. Automatyczne pobieranie server.jar',
                teamspeak: 'TeamSpeak 3 server. Automatyczna konfiguracja',
                rust: 'Wymaga SteamCMD. Pobierze przy pierwszym uruchomieniu',
                csgo: 'Wymaga SteamCMD. Source Dedicated Server',
                ark: 'Wymaga SteamCMD. ARK: Survival Evolved'
            };
            
            infoText.textContent = info[type] || 'Serwer gry';
            infoBox.style.display = 'block';
        }
        
        function renderServers() {
            const serverList = document.getElementById('serverList');
            serverList.innerHTML = '';
            
            if (servers.length === 0) {
                serverList.innerHTML = '<li class="server-item" style="text-align: center; color: #666;">Brak serwer√≥w. Utw√≥rz pierwszy serwer!</li>';
                return;
            }
            
            servers.forEach(server => {
                const serverItem = document.createElement('li');
                serverItem.className = 'server-item';
                
                serverItem.innerHTML = `
                    <div class="server-info">
                        <h4>${getServerIcon(server.type)} ${server.name}</h4>
                        <p>Typ: ${server.type} | Port: ${server.port} | Sloty: ${server.slots}</p>
                        <small>Katalog: ${server.directory} | PID: ${server.pid || 'Brak'}</small>
                    </div>
                    <div style="text-align: right;">
                        <div class="server-status ${getStatusClass(server.status)}">
                            ${getStatusText(server.status)}
                        </div>
                        <div style="margin-top: 8px; font-size: 0.9em;">
                            Wersja: ${server.version}
                        </div>
                        <div class="server-actions" style="margin-top: 8px;">
                            ${server.status === 'offline' ? 
                                `<button class="btn btn-success btn-sm" onclick="startRealServer(${server.id})">‚ñ∂ Start</button>` : 
                                `<button class="btn btn-danger btn-sm" onclick="stopRealServer(${server.id})">‚èπ Stop</button>`
                            }
                            <button class="btn btn-warning btn-sm" onclick="showServerLogs(${server.id})">üìã Logi</button>
                            <button class="btn btn-danger btn-sm" onclick="deleteRealServer(${server.id})">üóëÔ∏è</button>
                        </div>
                    </div>
                `;
                
                serverList.appendChild(serverItem);
            });
        }
        
        function getServerIcon(type) {
            const icons = {
                'minecraft': '‚õèÔ∏è',
                'rust': 'ü¶Ä',
                'ark': 'ü¶ñ',
                'csgo': 'üî´',
                'teamspeak': 'üéß'
            };
            return icons[type] || 'üñ•Ô∏è';
        }
        
        function getStatusClass(status) {
            const classes = {
                'online': 'status-online',
                'offline': 'status-offline',
                'starting': 'status-starting',
                'stopping': 'status-warning'
            };
            return classes[status] || 'status-offline';
        }
        
        function getStatusText(status) {
            const texts = {
                'online': 'üü¢ ONLINE',
                'offline': 'üî¥ OFFLINE',
                'starting': 'üü° URUCHAMIANIE',
                'stopping': 'üü† ZATRZYMYWANIE'
            };
            return texts[status] || 'üî¥ OFFLINE';
        }
        
        function showServerLogs(serverId) {
            const server = servers.find(s => s.id === serverId);
            if (server) {
                alert(`Logi serwera: ${server.name}\n\n≈öcie≈ºka do log√≥w: ${server.directory}/server.log\n\nLogi sƒÖ dostƒôpne bezpo≈õrednio w katalogu serwera.`);
            }
        }
        
        function updateStats() {
            document.getElementById('totalServers').textContent = servers.length;
            document.getElementById('runningServers').textContent = servers.filter(s => s.status === 'online').length;
            document.getElementById('usedPorts').textContent = servers.length;
        }
        
        function refreshAll() {
            loadServers();
            alert('üîÑ System od≈õwie≈ºony!');
        }
        
        // Inicjalizacja
        document.addEventListener('DOMContentLoaded', function() {
            loadServers();
            
            // Automatyczne od≈õwie≈ºanie co 10 sekund
            setInterval(loadServers, 10000);
        });
    </script>
</body>
</html>
HTML

    # Utw√≥rz backend API w Pythonie
    cat > "$WEB_DIR/api_server.py" << 'PYTHON'
#!/usr/bin/env python3
import http.server
import socketserver
import json
import os
import sys
import subprocess
import threading
from urllib.parse import urlparse, parse_qs
import time

# Konfiguracja
PANEL_DIR = "/home/purplehost"
SERVER_DIR = os.path.join(PANEL_DIR, "serwery")
LOG_DIR = os.path.join(PANEL_DIR, "logs")
PORT = 8080

# Baza danych serwer√≥w (pliku JSON)
SERVERS_DB = os.path.join(PANEL_DIR, "servers.json")

def load_servers():
    """Za≈Çaduj listƒô serwer√≥w z pliku JSON"""
    try:
        with open(SERVERS_DB, 'r') as f:
            return json.load(f)
    except:
        return []

def save_servers(servers):
    """Zapisz listƒô serwer√≥w do pliku JSON"""
    with open(SERVERS_DB, 'w') as f:
        json.dump(servers, f, indent=2)

def get_next_server_id():
    """Pobierz nastƒôpny dostƒôpny ID serwera"""
    servers = load_servers()
    if not servers:
        return 1
    return max(server['id'] for server in servers) + 1

def create_server_directory(server_type, server_id):
    """Utw√≥rz katalog dla serwera"""
    server_path = os.path.join(SERVER_DIR, server_type, f"server_{server_id}")
    os.makedirs(server_path, exist_ok=True)
    return server_path

def setup_minecraft_server(server_dir, version, port, slots):
    """Skonfiguruj serwer Minecraft"""
    try:
        os.chdir(server_dir)
        
        # Pobierz serwer Minecraft
        if version == "Najnowsza":
            jar_url = "https://piston-data.mojang.com/v1/objects/8f3112a1049751cc472ec13e397eade5336ca7ae/server.jar"
        else:
            jar_url = "https://piston-data.mojang.com/v1/objects/8f3112a1049751cc472ec13e397eade5336ca7ae/server.jar"
        
        # Pobierz plik JAR
        subprocess.run(["wget", "-q", jar_url, "-O", "server.jar"], check=True)
        
        # Utw√≥rz eula.txt
        with open("eula.txt", "w") as f:
            f.write("eula=true\n")
        
        # Podstawowa konfiguracja server.properties
        with open("server.properties", "w") as f:
            f.write(f"""server-port={port}
online-mode=false
level-type=default
max-players={slots}
motd=PurpleHost Minecraft Server
view-distance=10
""")
        
        return True
    except Exception as e:
        print(f"B≈ÇƒÖd konfiguracji Minecraft: {e}")
        return False

def setup_teamspeak_server(server_dir, port):
    """Skonfiguruj serwer TeamSpeak 3"""
    try:
        os.chdir(server_dir)
        
        # Pobierz TeamSpeak (symulacja - w rzeczywisto≈õci wymaga akceptacji licencji)
        ts_url = "http://dl.4players.de/ts/releases/3.13.7/teamspeak3-server_linux_amd64-3.13.7.tar.bz2"
        subprocess.run(["wget", "-q", ts_url], check=True)
        subprocess.run(["tar", "-xjf", "teamspeak3-server_linux_amd64-3.13.7.tar.bz2"], check=True)
        subprocess.run(["mv", "teamspeak3-server_linux_amd64/*", "."], check=True)
        subprocess.run(["rm", "-rf", "teamspeak3-server_linux_amd64*"], check=True)
        
        # Utw√≥rz plik konfiguracyjny
        with open("ts3server.ini", "w") as f:
            f.write(f"""machine_id=
default_voice_port={port}
voice_ip=0.0.0.0
licensepath=
filetransfer_port=30033
filetransfer_ip=0.0.0.0
query_port=10011
query_ip=0.0.0.0
query_ip_whitelist=query_ip_whitelist.txt
query_ip_blacklist=query_ip_blacklist.txt
dbplugin=ts3db_sqlite3
dbpluginparameter=
dbsqlpath=sql/
dbsqlcreatepath=create_sqlite/
logpath=logs
logquerycommands=1
dbclientkeepdays=30
logappend=0
""")
        
        return True
    except Exception as e:
        print(f"B≈ÇƒÖd konfiguracji TeamSpeak: {e}")
        return False

def start_minecraft_server(server_dir):
    """Uruchom serwer Minecraft"""
    try:
        os.chdir(server_dir)
        
        # Sprawd≈∫ czy serwer ju≈º dzia≈Ça
        pid_file = os.path.join(server_dir, "server.pid")
        if os.path.exists(pid_file):
            with open(pid_file, 'r') as f:
                pid = int(f.read().strip())
            try:
                # Sprawd≈∫ czy proces jeszcze istnieje
                os.kill(pid, 0)
                return {"success": True, "pid": pid, "message": "Serwer ju≈º dzia≈Ça"}
            except:
                # Proces nie istnieje, usu≈Ñ stary plik PID
                os.remove(pid_file)
        
        # Uruchom serwer
        process = subprocess.Popen(
            ["java", "-Xmx1024M", "-Xms1024M", "-jar", "server.jar", "nogui"],
            stdout=open(os.path.join(server_dir, "server.log"), "w"),
            stderr=subprocess.STDOUT
        )
        
        # Zapisz PID
        with open(pid_file, 'w') as f:
            f.write(str(process.pid))
        
        return {"success": True, "pid": process.pid}
        
    except Exception as e:
        return {"success": False, "error": str(e)}

def stop_minecraft_server(server_dir):
    """Zatrzymaj serwer Minecraft"""
    try:
        pid_file = os.path.join(server_dir, "server.pid")
        if os.path.exists(pid_file):
            with open(pid_file, 'r') as f:
                pid = int(f.read().strip())
            
            # Zabij proces
            subprocess.run(["kill", str(pid)])
            
            # Poczekaj chwilƒô
            time.sleep(2)
            
            # Sprawd≈∫ czy proces zosta≈Ç zabity
            try:
                os.kill(pid, 0)
                # Je≈õli jeszcze ≈ºyje, u≈ºyj force kill
                subprocess.run(["kill", "-9", str(pid)])
            except:
                pass
            
            # Usu≈Ñ plik PID
            os.remove(pid_file)
            
            return {"success": True}
        else:
            return {"success": False, "error": "Plik PID nie istnieje"}
    except Exception as e:
        return {"success": False, "error": str(e)}

def start_teamspeak_server(server_dir):
    """Uruchom serwer TeamSpeak"""
    try:
        os.chdir(server_dir)
        
        pid_file = os.path.join(server_dir, "ts3server.pid")
        if os.path.exists(pid_file):
            with open(pid_file, 'r') as f:
                pid = int(f.read().strip())
            try:
                os.kill(pid, 0)
                return {"success": True, "pid": pid, "message": "Serwer ju≈º dzia≈Ça"}
            except:
                os.remove(pid_file)
        
        # Uruchom serwer TeamSpeak
        process = subprocess.Popen(
            ["./ts3server_startscript.sh", "start"],
            stdout=open(os.path.join(server_dir, "ts3server.log"), "w"),
            stderr=subprocess.STDOUT
        )
        
        # Poczekaj na uruchomienie
        time.sleep(5)
        
        # Spr√≥buj znale≈∫ƒá PID
        try:
            # TeamSpeak tworzy w≈Çasny plik PID
            if os.path.exists("ts3server.pid"):
                with open("ts3server.pid", 'r') as f:
                    ts_pid = int(f.read().strip())
                with open(pid_file, 'w') as f:
                    f.write(str(ts_pid))
                return {"success": True, "pid": ts_pid}
        except:
            pass
        
        with open(pid_file, 'w') as f:
            f.write(str(process.pid))
        
        return {"success": True, "pid": process.pid}
        
    except Exception as e:
        return {"success": False, "error": str(e)}

def stop_teamspeak_server(server_dir):
    """Zatrzymaj serwer TeamSpeak"""
    try:
        os.chdir(server_dir)
        subprocess.run(["./ts3server_startscript.sh", "stop"], check=True)
        
        pid_file = os.path.join(server_dir, "ts3server.pid")
        if os.path.exists(pid_file):
            os.remove(pid_file)
        
        return {"success": True}
    except Exception as e:
        return {"success": False, "error": str(e)}

class PurpleHostAPIHandler(http.server.SimpleHTTPRequestHandler):
    def do_GET(self):
        # Obs≈Çuga statycznych plik√≥w
        if self.path.startswith('/api'):
            self.handle_api()
        else:
            super().do_GET()
    
    def do_POST(self):
        if self.path == '/api':
            self.handle_api()
        else:
            self.send_error(404)
    
    def handle_api(self):
        """Obs≈Çu≈º ≈ºƒÖdanie API"""
        try:
            content_length = int(self.headers['Content-Length'])
            post_data = self.rfile.read(content_length)
            request_data = json.loads(post_data.decode('utf-8'))
            
            action = request_data.get('action')
            
            if action == 'get_servers':
                self.get_servers()
            elif action == 'create_server':
                self.create_server(request_data)
            elif action == 'start_server':
                self.start_server(request_data)
            elif action == 'stop_server':
                self.stop_server(request_data)
            elif action == 'delete_server':
                self.delete_server(request_data)
            else:
                self.send_json_response({"success": False, "error": "Nieznana akcja"})
                
        except Exception as e:
            self.send_json_response({"success": False, "error": str(e)})
    
    def send_json_response(self, data):
        """Wy≈õlij odpowied≈∫ JSON"""
        self.send_response(200)
        self.send_header('Content-type', 'application/json')
        self.send_header('Access-Control-Allow-Origin', '*')
        self.end_headers()
        self.wfile.write(json.dumps(data).encode('utf-8'))
    
    def get_servers(self):
        """Pobierz listƒô wszystkich serwer√≥w"""
        servers = load_servers()
        
        # Zaktualizuj status ka≈ºdego serwera
        for server in servers:
            server_dir = server['directory']
            pid_file = os.path.join(server_dir, "server.pid" if server['type'] == 'minecraft' else "ts3server.pid")
            
            if os.path.exists(pid_file):
                with open(pid_file, 'r') as f:
                    pid = int(f.read().strip())
                try:
                    os.kill(pid, 0)
                    server['status'] = 'online'
                    server['pid'] = pid
                except:
                    server['status'] = 'offline'
                    server['pid'] = None
            else:
                server['status'] = 'offline'
                server['pid'] = None
        
        save_servers(servers)
        self.send_json_response({"success": True, "servers": servers})
    
    def create_server(self, data):
        """Utw√≥rz nowy serwer"""
        try:
            server_id = get_next_server_id()
            server_type = data['type']
            server_name = data['name']
            slots = data['slots']
            version = data['version']
            port = int(data['port'])
            
            # Utw√≥rz katalog serwera
            server_dir = create_server_directory(server_type, server_id)
            
            # Skonfiguruj serwer w zale≈ºno≈õci od typu
            success = False
            if server_type == 'minecraft':
                success = setup_minecraft_server(server_dir, version, port, slots)
            elif server_type == 'teamspeak':
                success = setup_teamspeak_server(server_dir, port)
            else:
                # Dla innych typ√≥w tworzymy tylko katalog
                success = True
            
            if success:
                # Dodaj serwer do bazy danych
                server_data = {
                    'id': server_id,
                    'name': server_name,
                    'type': server_type,
                    'slots': slots,
                    'version': version,
                    'port': port,
                    'directory': server_dir,
                    'status': 'offline',
                    'pid': None,
                    'created_at': time.time()
                }
                
                servers = load_servers()
                servers.append(server_data)
                save_servers(servers)
                
                self.send_json_response({
                    "success": True,
                    "server_id": server_id,
                    "server_dir": server_dir,
                    "port": port
                })
            else:
                self.send_json_response({"success": False, "error": "B≈ÇƒÖd konfiguracji serwera"})
                
        except Exception as e:
            self.send_json_response({"success": False, "error": str(e)})
    
    def start_server(self, data):
        """Uruchom serwer"""
        try:
            server_id = data['server_id']
            servers = load_servers()
            server = next((s for s in servers if s['id'] == server_id), None)
            
            if not server:
                self.send_json_response({"success": False, "error": "Serwer nie znaleziony"})
                return
            
            server_dir = server['directory']
            result = None
            
            if server['type'] == 'minecraft':
                result = start_minecraft_server(server_dir)
            elif server['type'] == 'teamspeak':
                result = start_teamspeak_server(server_dir)
            else:
                result = {"success": False, "error": "Typ serwera nieobs≈Çugiwany"}
            
            if result['success']:
                # Zaktualizuj status serwera
                server['status'] = 'online'
                server['pid'] = result.get('pid')
                save_servers(servers)
            
            self.send_json_response(result)
            
        except Exception as e:
            self.send_json_response({"success": False, "error": str(e)})
    
    def stop_server(self, data):
        """Zatrzymaj serwer"""
        try:
            server_id = data['server_id']
            servers = load_servers()
            server = next((s for s in servers if s['id'] == server_id), None)
            
            if not server:
                self.send_json_response({"success": False, "error": "Serwer nie znaleziony"})
                return
            
            server_dir = server['directory']
            result = None
            
            if server['type'] == 'minecraft':
                result = stop_minecraft_server(server_dir)
            elif server['type'] == 'teamspeak':
                result = stop_teamspeak_server(server_dir)
            else:
                result = {"success": False, "error": "Typ serwera nieobs≈Çugiwany"}
            
            if result['success']:
                # Zaktualizuj status serwera
                server['status'] = 'offline'
                server['pid'] = None
                save_servers(servers)
            
            self.send_json_response(result)
            
        except Exception as e:
            self.send_json_response({"success": False, "error": str(e)})
    
    def delete_server(self, data):
        """Usu≈Ñ serwer"""
        try:
            server_id = data['server_id']
            servers = load_servers()
            server = next((s for s in servers if s['id'] == server_id), None)
            
            if not server:
                self.send_json_response({"success": False, "error": "Serwer nie znaleziony"})
                return
            
            # Zatrzymaj serwer je≈õli dzia≈Ça
            if server['status'] == 'online':
                self.stop_server(data)
            
            # Usu≈Ñ katalog serwera
            server_dir = server['directory']
            subprocess.run(["rm", "-rf", server_dir])
            
            # Usu≈Ñ z bazy danych
            servers = [s for s in servers if s['id'] != server_id]
            save_servers(servers)
            
            self.send_json_response({"success": True})
            
        except Exception as e:
            self.send_json_response({"success": False, "error": str(e)})

def start_api_server():
    """Uruchom serwer API"""
    os.chdir(WEB_DIR)
    
    handler = PurpleHostAPIHandler
    with socketserver.TCPServer(("", PORT), handler) as httpd:
        print(f"üü£ PurpleHost API Server dzia≈Ça na porcie {PORT}")
        print(f"üåê Panel dostƒôpny pod: http://localhost:{PORT}")
        httpd.serve_forever()

if __name__ == "__main__":
    start_api_server()
PYTHON

    chmod +x "$WEB_DIR/api_server.py"

    # Utw√≥rz plik servers.json je≈õli nie istnieje
    if [ ! -f "$PANEL_DIR/servers.json" ]; then
        echo "[]" > "$PANEL_DIR/servers.json"
    fi

    echo -e "${GREEN}‚úÖ Panel PurpleHost z prawdziwymi serwerami zosta≈Ç utworzony!${NC}"
    echo -e "${PURPLE}üìÅ Lokalizacja: $WEB_DIR/${NC}"
    echo -e "${PURPLE}üéÆ Katalog serwer√≥w: $SERVER_DIR/${NC}"
    echo -e "${PURPLE}üìä Baza danych: $PANEL_DIR/servers.json${NC}"
}

start_web_server() {
    echo -e "${PURPLE}üåê URUCHAMIANIE SERWERA PURPLEHOST Z API...${NC}"
    
    # Sprawd≈∫ czy panel web istnieje
    if [ ! -f "$WEB_DIR/index.html" ]; then
        echo -e "${YELLOW}üìù Tworzenie panelu PurpleHost...${NC}"
        create_web_panel
    fi
    
    # Sprawd≈∫ czy port jest dostƒôpny
    if lsof -Pi :$PORT -sTCP:LISTEN -t >/dev/null ; then
        echo -e "${YELLOW}üîÑ Port $PORT jest zajƒôty, zatrzymywanie istniejƒÖcego serwera...${NC}"
        pkill -f "api_server.py"
        sleep 2
    fi
    
    # Uruchom serwer API Python
    cd "$WEB_DIR"
    python3 api_server.py &
    local api_pid=$!
    
    sleep 2
    
    if ps -p $api_pid > /dev/null 2>&1; then
        local ip=$(hostname -I | awk '{print $1}')
        
        echo -e "${GREEN}‚úÖ Serwer PurpleHost z API uruchomiony!${NC}"
        echo -e "${PURPLE}üåê Adresy dostƒôpu:${NC}"
        echo -e "   üìç Local:    http://localhost:$PORT"
        echo -e "   üåç Sieƒá:     http://$ip:$PORT"
        echo -e ""
        echo -e "${YELLOW}üéÆ Funkcjonalno≈õci:${NC}"
        echo -e "   ‚úÖ Tworzenie prawdziwych serwer√≥w Minecraft"
        echo -e "   ‚úÖ Tworzenie prawdziwych serwer√≥w TeamSpeak 3"
        echo -e "   ‚úÖ Uruchamianie/zatrzymywanie serwer√≥w"
        echo -e "   ‚úÖ ZarzƒÖdzanie portami i konfiguracjƒÖ"
        echo -e "   ‚úÖ Prawdziwe procesy w tle"
        
        if [ -n "$DISPLAY" ]; then
            echo -e "${YELLOW}üñ•Ô∏è  Otwieranie przeglƒÖdarki...${NC}"
            xdg-open "http://localhost:$PORT" 2>/dev/null &
        fi
    else
        error "‚ùå Nie uda≈Ço siƒô uruchomiƒá serwera API!"
        # Fallback to simple HTTP server
        echo -e "${YELLOW}üîÑ Uruchamianie prostego serwera HTTP...${NC}"
        python3 -m http.server $PORT &
    fi
}

# ... (reszta funkcji jak w poprzednim skrypcie - show_menu, show_panel_info, etc.)

# =============================================
# üìú MAIN SCRIPT
# =============================================

# Inicjalizacja
mkdir -p "$PANEL_DIR"
setup_directories
check_dependencies

clear

echo -e "${PURPLE}"
echo -e "‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó"
echo -e "‚ïë        üü£ PURPLEHOST PRO             ‚ïë"
echo -e "‚ïë      PRAWDZIWE SERWERY GRY           ‚ïë"
echo -e "‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù"
echo -e "${NC}"
echo -e "${CYAN}Katalog panelu: $PANEL_DIR${NC}"
echo -e "${CYAN}Katalog serwer√≥w: $SERVER_DIR${NC}"
echo -e "${CYAN}Port serwera: $PORT${NC}"
echo ""

# Uruchom menu g≈Ç√≥wne
while true; do
    show_menu
    read -p "Tw√≥j wyb√≥r: " choice
    
    case $choice in
        1)
            create_web_panel
            ;;
        2)
            start_web_server
            ;;
        3)
            stop_web_server
            ;;
        4)
            echo -e "${PURPLE}üöÄ Tworzenie i uruchamianie panelu PurpleHost...${NC}"
            create_web_panel
            start_web_server
            ;;
        5)
            show_panel_info
            ;;
        0)
            echo -e "${PURPLE}üëã Do widzenia!${NC}"
            stop_web_server
            exit 0
            ;;
        *)
            echo -e "${RED}‚ùå Nieprawid≈Çowy wyb√≥r!${NC}"
            ;;
    esac
    
    echo ""
    read -p "Naci≈õnij Enter aby kontynuowaƒá..."
    clear
done
