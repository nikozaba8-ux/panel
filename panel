#!/bin/bash

# =============================================
# ğŸ¦– PTERODACTYL-LIKE PANEL - CODESANDBOX VERSION
# =============================================

# Konfiguracja dla Å›rodowiska online
PANEL_DIR="/tmp/panel"
SERVERS_DIR="$PANEL_DIR/servers"
LOGS_DIR="$PANEL_DIR/logs"
BACKUPS_DIR="$PANEL_DIR/backups"
CONFIG_DIR="$PANEL_DIR/config"
WEB_DIR="$PANEL_DIR/web"
USERS_DIR="$PANEL_DIR/users"
DATABASES_DIR="$PANEL_DIR/databases"
RESOURCES_DIR="$PANEL_DIR/resources"
PANEL_BACKUP_DIR="$PANEL_DIR/panel-backups"
PID_FILE="$PANEL_DIR/panel.pid"
PORT=8080

# Kolory dla output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
PURPLE='\033[0;35m'
CYAN='\033[0;36m'
NC='\033[0m'

# =============================================
# ğŸ› ï¸ FUNKCJE POMOCNICZE
# =============================================

log() {
    echo -e "${GREEN}[$(date '+%Y-%m-%d %H:%M:%S')]${NC} $1" | tee -a "$LOGS_DIR/panel.log"
}

error() {
    echo -e "${RED}[BÅÄ„D]${NC} $1" | tee -a "$LOGS_DIR/panel.log"
}

warning() {
    echo -e "${YELLOW}[OSTRZEÅ»ENIE]${NC} $1" | tee -a "$LOGS_DIR/panel.log"
}

setup_directories() {
    mkdir -p "$SERVERS_DIR" "$LOGS_DIR" "$BACKUPS_DIR" "$CONFIG_DIR" "$WEB_DIR" \
             "$USERS_DIR" "$DATABASES_DIR" "$RESOURCES_DIR" "$PANEL_BACKUP_DIR"
    log "Katalogi utworzone"
}

# =============================================
# ğŸŒ SERWER WEB - LIGHTWEIGHT VERSION
# =============================================

check_port_available() {
    if command -v nc >/dev/null 2>&1; then
        if ! nc -z localhost $1 2>/dev/null; then
            return 0
        else
            return 1
        fi
    else
        # Fallback - sprawdÅº przez /proc/net/tcp
        if [ -f /proc/net/tcp ]; then
            if ! grep ":$1 " /proc/net/tcp >/dev/null 2>&1; then
                return 0
            else
                return 1
            fi
        else
            # Ostateczny fallback - zaÅ‚Ã³Å¼my Å¼e port jest dostÄ™pny
            return 0
        fi
    fi
}

find_available_port() {
    local start_port=8080
    local max_port=8100
    local port=$start_port
    
    while [ $port -le $max_port ]; do
        if check_port_available $port; then
            echo $port
            return 0
        fi
        port=$((port + 1))
    done
    
    # JeÅ›li nie znaleziono, uÅ¼yj losowego portu > 8100
    echo $((8100 + RANDOM % 1000))
}

start_web_server() {
    # SprawdÅº i znajdÅº port
    if ! check_port_available $PORT; then
        warning "Port $PORT jest zajÄ™ty, szukam wolnego portu..."
        NEW_PORT=$(find_available_port)
        if [ $? -eq 0 ]; then
            PORT=$NEW_PORT
            log "UÅ¼ywam portu: $PORT"
        else
            error "Nie moÅ¼na znaleÅºÄ‡ wolnego portu!"
            return 1
        fi
    fi

    # Zatrzymaj istniejÄ…cy serwer jeÅ›li dziaÅ‚a
    stop_web_server

    log "Uruchamianie serwera web na porcie $PORT..."
    
    # Uruchom prosty serwer HTTP w Pythonie (dziaÅ‚a w CodeSandbox)
    cd "$WEB_DIR"
    python3 -m http.server $PORT > "$LOGS_DIR/webserver.log" 2>&1 &
    
    echo $! > "$PID_FILE"
    log "âœ… Serwer web uruchomiony na porcie $PORT"
    
    # WyÅ›wietl informacje o dostÄ™pie
    echo -e "${GREEN}ğŸŒ Panel jest dostÄ™pny pod adresem:${NC}"
    echo -e "${CYAN}  â¡ï¸  http://localhost:$PORT${NC}"
    echo -e "${YELLOW}  ğŸ“ W CodeSandbox: SprawdÅº 'Ports' w dolnym panelu${NC}"
    
    return 0
}

stop_web_server() {
    if [ -f "$PID_FILE" ]; then
        local pid=$(cat "$PID_FILE")
        if ps -p "$pid" > /dev/null 2>&1; then
            kill "$pid" 2>/dev/null
            wait "$pid" 2>/dev/null
            log "Serwer web zatrzymany"
        fi
        rm -f "$PID_FILE"
    fi
    
    # Zabij rÃ³wnieÅ¼ procesy Pythona serwujÄ…cego
    pkill -f "python3 -m http.server" 2>/dev/null
}

# =============================================
# ğŸŒ INTERFEJS WEB - CODESANDBOX OPTIMIZED
# =============================================

create_web_interface() {
    # Strona gÅ‚Ã³wna Admin
    cat > "$WEB_DIR/index.html" << 'EOF'
<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¦– Panel Pterodactyl - CodeSandbox</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh; 
            color: #333; 
            padding: 20px;
        }
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        .header { 
            text-align: center; 
            margin-bottom: 40px;
        }
        .header h1 { 
            font-size: 3em; 
            margin-bottom: 10px; 
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent; 
        }
        .status {
            background: #c6f6d5;
            color: #276749;
            padding: 10px 20px;
            border-radius: 20px;
            display: inline-block;
            font-weight: bold;
            margin: 5px;
        }
        .info-box {
            background: #e0f2fe;
            border: 2px solid #bae6fd;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        .card-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
            gap: 20px; 
            margin-bottom: 30px; 
        }
        .card { 
            background: white; 
            padding: 30px; 
            border-radius: 15px; 
            text-align: center; 
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1); 
            transition: transform 0.3s ease; 
            border-left: 4px solid #4299e1;
        }
        .card:hover { transform: translateY(-5px); }
        .card h3 { margin-bottom: 15px; color: #2d3748; }
        .card p { color: #718096; margin-bottom: 20px; }
        .btn { 
            display: inline-block; 
            padding: 12px 30px; 
            background: #4299e1; 
            color: white; 
            text-decoration: none; 
            border-radius: 8px; 
            font-weight: 600; 
            transition: all 0.3s ease; 
            border: none;
            cursor: pointer;
            font-size: 1em;
            margin: 5px;
        }
        .btn-success { background: #48bb78; }
        .btn-warning { background: #ed8936; }
        .btn-danger { background: #e53e3e; }
        .btn-info { background: #38b2ac; }
        .btn:hover { opacity: 0.9; transform: translateY(-2px); }
        
        .codesandbox-info {
            background: #fff3cd;
            border: 2px solid #ffeaa7;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
        }
        .server-status {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
        }
        .online { color: #48bb78; }
        .offline { color: #e53e3e; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¦– Panel Pterodactyl</h1>
            <p>CodeSandbox Edition â€¢ <span class="status">âœ… ONLINE</span></p>
        </div>

        <div class="codesandbox-info">
            <h3>ğŸš€ DziaÅ‚a w CodeSandbox!</h3>
            <p>Ten panel zostaÅ‚ uruchomiony w Å›rodowisku CodeSandbox. MoÅ¼esz teraz testowaÄ‡ funkcjonalnoÅ›ci zarzÄ…dzania serwerami.</p>
        </div>

        <div class="info-box">
            <h3>ğŸ“Š Status Systemu</h3>
            <div class="server-status">
                <strong>Serwer Web:</strong> <span class="online">â— DZIAÅA</span>
            </div>
            <div class="server-status">
                <strong>Baza Danych:</strong> <span class="online">â— DOSTÄ˜PNA</span>
            </div>
            <div class="server-status">
                <strong>API Panelu:</strong> <span class="online">â— AKTYWNE</span>
            </div>
        </div>

        <div class="card-grid">
            <div class="card">
                <h3>ğŸ‘¥ UÅ¼ytkownicy</h3>
                <p>ZarzÄ…dzaj uÅ¼ytkownikami systemu</p>
                <button class="btn" onclick="showSection('users')">PrzejdÅº</button>
            </div>
            <div class="card">
                <h3>ğŸ® Serwery</h3>
                <p>TwÃ³rz i zarzÄ…dzaj serwerami</p>
                <button class="btn" onclick="showSection('servers')">PrzejdÅº</button>
            </div>
            <div class="card">
                <h3>ğŸ“Š Statystyki</h3>
                <p>Monitoruj wydajnoÅ›Ä‡ systemu</p>
                <button class="btn" onclick="showSection('stats')">PrzejdÅº</button>
            </div>
        </div>

        <div class="card-grid">
            <div class="card">
                <h3>ğŸ”§ ZarzÄ…dzanie</h3>
                <p>Backup, reinstalacja, ustawienia</p>
                <button class="btn btn-warning" onclick="showSection('management')">ZarzÄ…dzaj</button>
            </div>
            <div class="card">
                <h3>ğŸ‘¤ Panel Klienta</h3>
                <p>PrzejdÅº do panelu klienta</p>
                <button class="btn btn-success" onclick="showSection('client')">Client Area</button>
            </div>
            <div class="card">
                <h3>ğŸ”„ OdÅ›wieÅ¼</h3>
                <p>PrzeÅ‚aduj panel</p>
                <button class="btn btn-info" onclick="location.reload()">ğŸ”„ OdÅ›wieÅ¼</button>
            </div>
        </div>

        <!-- Sekcje zawartoÅ›ci -->
        <div id="content-section" style="display: none; margin-top: 30px;">
            <div id="section-content"></div>
            <button class="btn" onclick="hideSection()" style="margin-top: 20px;">â† PowrÃ³t</button>
        </div>
    </div>

    <script>
        const sections = {
            users: `
                <h2>ğŸ‘¥ ZarzÄ…dzanie UÅ¼ytkownikami</h2>
                <div class="server-status">
                    <h4>Lista UÅ¼ytkownikÃ³w</h4>
                    <ul style="list-style: none; padding: 15px;">
                        <li style="padding: 10px; border-bottom: 1px solid #eee;">
                            <strong>testuser</strong> - test@example.com 
                            <span class="online" style="float: right;">â— AKTYWNY</span>
                        </li>
                        <li style="padding: 10px; border-bottom: 1px solid #eee;">
                            <strong>admin</strong> - admin@panel.com 
                            <span class="online" style="float: right;">â— AKTYWNY</span>
                        </li>
                    </ul>
                </div>
                <button class="btn btn-success">â• Dodaj UÅ¼ytkownika</button>
            `,
            servers: `
                <h2>ğŸ® ZarzÄ…dzanie Serwerami</h2>
                <div class="server-status">
                    <h4>Twoje Serwery</h4>
                    <div style="background: #f7fafc; padding: 15px; border-radius: 8px; margin: 10px 0;">
                        <h3>ğŸ¦– Minecraft Server</h3>
                        <p>Status: <span class="online">â— DZIAÅA</span></p>
                        <p>Port: 25565 â€¢ RAM: 2048MB â€¢ Gracze: 0/20</p>
                        <button class="btn btn-warning" style="padding: 5px 10px;">Restart</button>
                        <button class="btn btn-danger" style="padding: 5px 10px;">Stop</button>
                    </div>
                    <div style="background: #f7fafc; padding: 15px; border-radius: 8px; margin: 10px 0;">
                        <h3>ğŸ Python API</h3>
                        <p>Status: <span class="online">â— DZIAÅA</span></p>
                        <p>Port: 8000 â€¢ RAM: 512MB â€¢ Uptime: 2h 30m</p>
                        <button class="btn btn-warning" style="padding: 5px 10px;">Restart</button>
                        <button class="btn btn-danger" style="padding: 5px 10px;">Stop</button>
                    </div>
                </div>
                <button class="btn btn-success">â• UtwÃ³rz Nowy Serwer</button>
            `,
            stats: `
                <h2>ğŸ“Š Statystyki Systemu</h2>
                <div class="card-grid">
                    <div class="card">
                        <h3>ğŸ’¾ Zasoby</h3>
                        <p>CPU: <strong>15%</strong></p>
                        <p>RAM: <strong>1.2GB / 4GB</strong></p>
                        <p>Disk: <strong>450MB / 10GB</strong></p>
                    </div>
                    <div class="card">
                        <h3>ğŸŒ SieÄ‡</h3>
                        <p>Ruch: <strong>125MB</strong></p>
                        <p>PoÅ‚Ä…czenia: <strong>12</strong></p>
                        <p>Porty: <strong>3 aktywne</strong></p>
                    </div>
                    <div class="card">
                        <h3>ğŸ“ˆ WydajnoÅ›Ä‡</h3>
                        <p>Uptime: <strong>2h 30m</strong></p>
                        <p>Serwery: <strong>2 aktywne</strong></p>
                        <p>UÅ¼ytkownicy: <strong>2 online</strong></p>
                    </div>
                </div>
            `,
            management: `
                <h2>ğŸ”§ ZarzÄ…dzanie Systemem</h2>
                <div class="card-grid">
                    <div class="card">
                        <h3>ğŸ’¾ Backup</h3>
                        <p>UtwÃ³rz kopiÄ™ zapasowÄ… systemu</p>
                        <button class="btn btn-warning">UtwÃ³rz Backup</button>
                    </div>
                    <div class="card">
                        <h3>ğŸ”„ Restart</h3>
                        <p>Uruchom ponownie panel</p>
                        <button class="btn btn-info">Restart Panelu</button>
                    </div>
                    <div class="card">
                        <h3>âš™ï¸ Ustawienia</h3>
                        <p>Konfiguracja systemu</p>
                        <button class="btn">OtwÃ³rz Ustawienia</button>
                    </div>
                </div>
            `,
            client: `
                <h2>ğŸ‘‹ Witaj w Panelu Klienta!</h2>
                <div class="info-box">
                    <h3>Twoje Konto</h3>
                    <p><strong>Nazwa uÅ¼ytkownika:</strong> testuser</p>
                    <p><strong>Email:</strong> test@example.com</p>
                    <p><strong>Data rejestracji:</strong> 2024-01-01</p>
                </div>
                <div class="server-status">
                    <h3>ğŸ® Twoje Serwery</h3>
                    <p>Masz <strong>2 aktywne serwery</strong>:</p>
                    <ul style="list-style: none; padding: 15px;">
                        <li style="padding: 8px;">â€¢ Minecraft Server (25565) - <span class="online">DZIAÅA</span></li>
                        <li style="padding: 8px;">â€¢ Python API (8000) - <span class="online">DZIAÅA</span></li>
                    </ul>
                </div>
                <button class="btn btn-success">ğŸ”„ OdÅ›wieÅ¼ Status</button>
            `
        };

        function showSection(section) {
            document.getElementById('section-content').innerHTML = sections[section];
            document.getElementById('content-section').style.display = 'block';
            window.scrollTo(0, document.getElementById('content-section').offsetTop);
        }

        function hideSection() {
            document.getElementById('content-section').style.display = 'none';
        }

        // Symulacja Å‚adowania danych
        console.log('ğŸ¦– Panel Pterodactyl - CodeSandbox Edition zaÅ‚adowany!');
    </script>
</body>
</html>
EOF

    # Panel klienta
    mkdir -p "$WEB_DIR/client"
    cat > "$WEB_DIR/client/index.html" << 'EOF'
<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Klienta - CodeSandbox</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh; 
            color: #333; 
            padding: 20px;
        }
        .container { 
            max-width: 1000px; 
            margin: 0 auto; 
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        .header { 
            text-align: center; 
            margin-bottom: 40px;
        }
        .header h1 { 
            font-size: 2.5em; 
            margin-bottom: 10px; 
            color: #2d3748;
        }
        .server-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #48bb78;
        }
        .btn { 
            display: inline-block; 
            padding: 10px 20px; 
            background: #4299e1; 
            color: white; 
            text-decoration: none; 
            border-radius: 8px; 
            font-weight: 600; 
            border: none;
            cursor: pointer;
            margin: 5px;
        }
        .btn-success { background: #48bb78; }
        .online { color: #48bb78; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ‘‹ Witaj, testuser!</h1>
            <p>Panel Klienta - ZarzÄ…dzaj swoimi serwerami</p>
        </div>

        <div style="text-align: center; margin-bottom: 30px;">
            <button class="btn btn-success">â• UtwÃ³rz Nowy Serwer</button>
            <button class="btn">ğŸ”„ OdÅ›wieÅ¼ Status</button>
            <a href="/" class="btn">ğŸ  Panel Admina</a>
        </div>

        <div class="server-card">
            <h3>ğŸ® Minecraft Server</h3>
            <p>Status: <span class="online">â— DZIAÅA</span></p>
            <p><strong>Port:</strong> 25565</p>
            <p><strong>RAM:</strong> 2048MB</p>
            <p><strong>Gracze:</strong> 0/20 online</p>
            <div style="margin-top: 15px;">
                <button class="btn">âš™ï¸ ZarzÄ…dzaj</button>
                <button class="btn" style="background: #ed8936;">ğŸ”„ Restart</button>
                <button class="btn" style="background: #e53e3e;">ğŸ›‘ Stop</button>
            </div>
        </div>

        <div class="server-card">
            <h3>ğŸ Python API Server</h3>
            <p>Status: <span class="online">â— DZIAÅA</span></p>
            <p><strong>Port:</strong> 8000</p>
            <p><strong>RAM:</strong> 512MB</p>
            <p><strong>Uptime:</strong> 2 godziny 30 minut</p>
            <div style="margin-top: 15px;">
                <button class="btn">âš™ï¸ ZarzÄ…dzaj</button>
                <button class="btn" style="background: #ed8936;">ğŸ”„ Restart</button>
                <button class="btn" style="background: #e53e3e;">ğŸ›‘ Stop</button>
            </div>
        </div>

        <div style="background: #f7fafc; padding: 20px; border-radius: 10px; margin-top: 30px;">
            <h3>ğŸ“Š Statystyki Konta</h3>
            <p><strong>Limit serwerÃ³w:</strong> 2/10</p>
            <p><strong>Wykorzystana pamiÄ™Ä‡:</strong> 2.5GB / 8GB</p>
            <p><strong>Data rejestracji:</strong> 2024-01-01</p>
        </div>
    </div>

    <script>
        console.log('Panel klienta zaÅ‚adowany');
    </script>
</body>
</html>
EOF

    echo -e "${GREEN}âœ… Interfejs web utworzony${NC}"
}

# =============================================
# ğŸš€ SZYBKA INICJALIZACJA
# =============================================

quick_initialize() {
    echo -e "${BLUE}ğŸ¦– Inicjalizacja Panelu Pterodactyl (CodeSandbox)...${NC}"
    
    # UtwÃ³rz katalogi
    echo -e "${YELLOW}ğŸ“ Tworzenie struktur katalogÃ³w...${NC}"
    setup_directories
    
    # UtwÃ³rz podstawowego uÅ¼ytkownika
    if [ ! -f "$USERS_DIR/testuser.conf" ]; then
        cat > "$USERS_DIR/testuser.conf" << EOF
USERNAME="testuser"
USER_EMAIL="test@example.com"
USER_PASSWORD="test123"
USER_CREATED="$(date '+%Y-%m-%d %H:%M:%S')"
EOF
        echo -e "${GREEN}âœ… Utworzono uÅ¼ytkownika testowego${NC}"
    fi
    
    # UtwÃ³rz przykÅ‚adowe serwery
    cat > "$SERVERS_DIR/minecraft.json" << EOF
{
    "name": "Minecraft Server",
    "type": "minecraft",
    "port": 25565,
    "memory": 2048,
    "status": "running",
    "owner": "testuser"
}
EOF

    cat > "$SERVERS_DIR/python.json" << EOF
{
    "name": "Python API", 
    "type": "python",
    "port": 8000,
    "memory": 512,
    "status": "running",
    "owner": "testuser"
}
EOF

    # UtwÃ³rz interfejs web
    echo -e "${YELLOW}ğŸŒ Tworzenie interfejsu web...${NC}"
    create_web_interface
    
    # URUCHOM SERWER
    echo -e "${YELLOW}ğŸš€ Uruchamianie serwera web...${NC}"
    start_web_server
    
    if [ $? -eq 0 ]; then
        echo -e "${GREEN}=============================================${NC}"
        echo -e "${GREEN}ğŸ‰ PANEL PTERODACTYL JEST GOTOWY!${NC}"
        echo -e "${GREEN}=============================================${NC}"
        echo -e "${CYAN}ğŸ” Dane testowe:${NC}"
        echo -e "   UÅ¼ytkownik: ${GREEN}testuser${NC}"
        echo -e "   HasÅ‚o: ${GREEN}test123${NC}"
        echo -e "${GREEN}=============================================${NC}"
        echo -e "${YELLOW}ğŸ’¡ Panel jest dostÄ™pny pod:${NC}"
        echo -e "   ${CYAN}http://localhost:$PORT${NC}"
        echo -e "${YELLOW}ğŸ“± W CodeSandbox sprawdÅº zakÅ‚adkÄ™ 'Ports'${NC}"
    else
        echo -e "${RED}âŒ BÅ‚Ä…d podczas uruchamiania panelu${NC}"
        return 1
    fi
}

# =============================================
# ğŸ›‘ FUNKCJA SPRZÄ„TAJÄ„CA
# =============================================

cleanup() {
    echo -e "\n${YELLOW}ğŸ›‘ Zatrzymywanie panelu...${NC}"
    stop_web_server
    echo -e "${GREEN}âœ… Panel zostaÅ‚ zatrzymany${NC}"
    exit 0
}

# =============================================
# ğŸ¯ FUNKCJE ZARZÄ„DZANIA
# =============================================

show_status() {
    if [ -f "$PID_FILE" ]; then
        local pid=$(cat "$PID_FILE")
        if ps -p "$pid" > /dev/null 2>&1; then
            echo -e "${GREEN}âœ… Panel jest uruchomiony (PID: $pid)${NC}"
            echo -e "${CYAN}ğŸŒ Adres: http://localhost:$PORT${NC}"
        else
            echo -e "${RED}âŒ Panel nie jest uruchomiony${NC}"
        fi
    else
        echo -e "${RED}âŒ Panel nie jest uruchomiony${NC}"
    fi
}

show_help() {
    echo -e "${GREEN}ğŸ¦– Panel Pterodactyl - CodeSandbox Edition${NC}"
    echo ""
    echo -e "${CYAN}DostÄ™pne komendy:${NC}"
    echo -e "  ${YELLOW}start${NC}     - Uruchom panel"
    echo -e "  ${YELLOW}stop${NC}      - Zatrzymaj panel" 
    echo -e "  ${YELLOW}status${NC}    - PokaÅ¼ status panelu"
    echo -e "  ${YELLOW}help${NC}      - PokaÅ¼ tÄ™ pomoc"
    echo ""
    echo -e "${CYAN}PrzykÅ‚ad:${NC}"
    echo -e "  ${GREEN}bash panel.sh start${NC}"
}

# =============================================
# ğŸ“œ MAIN SCRIPT
# =============================================

# Zarejestruj trap dla sygnaÅ‚Ã³w
trap cleanup INT TERM

# SprawdÅº argumenty
case "${1:-}" in
    "start")
        quick_initialize
        
        # Czekaj na sygnaÅ‚ zakoÅ„czenia
        echo -e "${YELLOW}â³ Panel dziaÅ‚a... NaciÅ›nij Ctrl+C aby zatrzymaÄ‡${NC}"
        while true; do
            sleep 10
        done
        ;;
    "stop")
        stop_web_server
        ;;
    "status")
        show_status
        ;;
    "help"|"--help"|"-h")
        show_help
        ;;
    *)
        # DomyÅ›lnie pokaÅ¼ pomoc
        show_help
        ;;
esac
