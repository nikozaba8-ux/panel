#!/bin/bash

# =============================================
# ğŸŸ£ PURPLEHOST - SKLEP + PANEL KLIENTA
# =============================================

# Konfiguracja
PANEL_DIR="/home/purplehost"
WEB_DIR="$PANEL_DIR/web"
SERVER_DIR="$PANEL_DIR/serwery"
DB_DIR="$PANEL_DIR/bazy"
BACKUP_DIR="$PANEL_DIR/backupy"
LOG_DIR="$PANEL_DIR/logs"
NODE_DIR="$PANEL_DIR/node"
PORT=8080

# Kolory
PURPLE='\033[0;35m'
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
CYAN='\033[0;36m'
NC='\033[0m'

# =============================================
# ğŸ› ï¸ FUNKCJE POMOCNICZE
# =============================================

log() {
    echo -e "${PURPLE}[$(date '+%Y-%m-%d %H:%M:%S')]${NC} $1"
    echo "$(date '+%Y-%m-%d %H:%M:%S') - $1" >> "$LOG_DIR/panel.log"
}

setup_directories() {
    echo -e "${PURPLE}ğŸ“ Tworzenie struktur katalogÃ³w...${NC}"
    mkdir -p "$PANEL_DIR" "$WEB_DIR" "$SERVER_DIR" "$DB_DIR" "$BACKUP_DIR" "$LOG_DIR" "$NODE_DIR"
    mkdir -p "$SERVER_DIR/minecraft" "$SERVER_DIR/rust" "$SERVER_DIR/ark" "$SERVER_DIR/csgo" "$SERVER_DIR/teamspeak"
    log "Struktura katalogÃ³w PurpleHost utworzona"
}

check_dependencies() {
    echo -e "${PURPLE}ğŸ” Sprawdzanie zaleÅ¼noÅ›ci...${NC}"
    
    if ! command -v python3 &> /dev/null; then
        echo -e "${YELLOW}ğŸ“¦ Instalowanie Pythona 3...${NC}"
        apt update > /dev/null 2>&1
        apt install -y python3 > /dev/null 2>&1
    fi
    
    echo -e "${GREEN}âœ… Wszystkie zaleÅ¼noÅ›ci sÄ… dostÄ™pne${NC}"
}

# =============================================
# ğŸŒ TWORZENIE STRONY GÅÃ“WNEJ + SKLEPU + PANELU KLIENTA
# =============================================

create_web_panel() {
    echo -e "${PURPLE}ğŸŒ Tworzenie strony gÅ‚Ã³wnej PurpleHost...${NC}"
    
    # Strona gÅ‚Ã³wna - Sklep
    cat > "$WEB_DIR/index.html" << 'HTML'
<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸŸ£ PurpleHost - Professional Game Hosting</title>
    <style>
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body { 
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            padding: 15px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }
        
        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #6a11cb;
        }
        
        .nav-menu {
            display: flex;
            list-style: none;
            gap: 30px;
        }
        
        .nav-menu a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            padding: 8px 16px;
            border-radius: 5px;
            transition: all 0.3s ease;
        }
        
        .nav-menu a:hover, .nav-menu a.active {
            background: #6a11cb;
            color: white;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .hero {
            text-align: center;
            padding: 80px 20px;
            color: white;
        }
        
        .hero h1 {
            font-size: 3.5em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .hero p {
            font-size: 1.3em;
            margin-bottom: 30px;
            opacity: 0.9;
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
            font-size: 1.1em;
        }
        
        .btn-primary {
            background: #6a11cb;
            color: white;
        }
        
        .btn-primary:hover {
            background: #5a0db3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(106, 17, 203, 0.4);
        }
        
        .btn-outline {
            background: transparent;
            color: white;
            border: 2px solid white;
        }
        
        .btn-outline:hover {
            background: white;
            color: #6a11cb;
        }
        
        .warning-banner {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
            color: #856404;
        }
        
        .shop-section {
            background: white;
            border-radius: 20px;
            padding: 50px 30px;
            margin: 40px 0;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .section-title {
            text-align: center;
            color: #6a11cb;
            margin-bottom: 40px;
            font-size: 2.5em;
        }
        
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }
        
        .product-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .product-card:hover {
            transform: translateY(-10px);
            border-color: #6a11cb;
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
        }
        
        .product-icon {
            font-size: 3em;
            margin-bottom: 20px;
        }
        
        .product-title {
            color: #6a11cb;
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        
        .product-price {
            font-size: 2em;
            font-weight: bold;
            color: #28a745;
            margin: 20px 0;
        }
        
        .product-features {
            list-style: none;
            margin: 20px 0;
            text-align: left;
        }
        
        .product-features li {
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
        }
        
        .product-features li:before {
            content: "âœ… ";
            margin-right: 10px;
        }
        
        .footer {
            text-align: center;
            padding: 40px 20px;
            color: white;
            margin-top: 60px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }
        
        .client-panel-section {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 50px 30px;
            margin: 40px 0;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="nav-container">
            <div class="logo">ğŸŸ£ PurpleHost</div>
            <ul class="nav-menu">
                <li><a href="#" class="active">Strona GÅ‚Ã³wna</a></li>
                <li><a href="#" onclick="showSection('sklep')">Sklep</a></li>
                <li><a href="/client">Panel Klienta</a></li>
                <li><a href="#">Kontakt</a></li>
            </ul>
        </div>
    </div>

    <div class="container">
        <!-- Hero Section -->
        <div class="hero">
            <h1>ğŸŸ£ PurpleHost</h1>
            <p>Profesjonalny hosting serwerÃ³w gry â€¢ Najlepsze ceny â€¢ 99.9% Uptime</p>
            <div style="margin-top: 30px;">
                <a href="#" onclick="showSection('sklep')" class="btn btn-primary">ğŸ® Kup Serwer</a>
                <a href="/client" class="btn btn-outline">ğŸ‘¤ Panel Klienta</a>
            </div>
        </div>

        <div class="warning-banner">
            âš ï¸ <strong>Warning out...</strong> Not this convention postupancy is a twoism location.
        </div>

        <!-- Sklep -->
        <div id="sklep" class="shop-section">
            <h2 class="section-title">ğŸ® Sklep - Wybierz SwÃ³j Serwer</h2>
            
            <div class="products-grid">
                <div class="product-card">
                    <div class="product-icon">â›ï¸</div>
                    <h3 class="product-title">Minecraft</h3>
                    <div class="product-price">$5/miesiÄ…c</div>
                    <ul class="product-features">
                        <li>Nieograniczona liczba slotÃ³w</li>
                        <li>Dedykowane zasoby</li>
                        <li>Automatyczne backupy</li>
                        <li>Panel kontrolny</li>
                        <li>Support 24/7</li>
                    </ul>
                    <button class="btn btn-primary" onclick="buyProduct('minecraft')">ğŸ›’ Kup Teraz</button>
                </div>
                
                <div class="product-card">
                    <div class="product-icon">ğŸ¦€</div>
                    <h3 class="product-title">Rust</h3>
                    <div class="product-price">$8/miesiÄ…c</div>
                    <ul class="product-features">
                        <li>Serwer Rust z modami</li>
                        <li>Wysoka wydajnoÅ›Ä‡</li>
                        <li>Automatyczne aktualizacje</li>
                        <li>FTP dostÄ™p</li>
                        <li>MySQL baza danych</li>
                    </ul>
                    <button class="btn btn-primary" onclick="buyProduct('rust')">ğŸ›’ Kup Teraz</button>
                </div>
                
                <div class="product-card">
                    <div class="product-icon">ğŸ”«</div>
                    <h3 class="product-title">CS:GO</h3>
                    <div class="product-price">$6/miesiÄ…c</div>
                    <ul class="product-features">
                        <li>Niskie pingi</li>
                        <li>SourceMod + MetaMod</li>
                        <li>Custom mapy</li>
                        <li>Statystyki</li>
                        <li>Anti-Cheat</li>
                    </ul>
                    <button class="btn btn-primary" onclick="buyProduct('csgo')">ğŸ›’ Kup Teraz</button>
                </div>
            </div>
            
            <div class="products-grid">
                <div class="product-card">
                    <div class="product-icon">ğŸ¦–</div>
                    <h3 class="product-title">ARK: Survival</h3>
                    <div class="product-price">$10/miesiÄ…c</div>
                    <ul class="product-features">
                        <li>Najnowsza wersja ARK</li>
                        <li>Mod support</li>
                        <li>Automatyczne backupy</li>
                        <li>Cluster support</li>
                        <li>TCAdmin panel</li>
                    </ul>
                    <button class="btn btn-primary" onclick="buyProduct('ark')">ğŸ›’ Kup Teraz</button>
                </div>
                
                <div class="product-card">
                    <div class="product-icon">ğŸ§</div>
                    <h3 class="product-title">TeamSpeak 3</h3>
                    <div class="product-price">$3/miesiÄ…c</div>
                    <ul class="product-features">
                        <li>512 slotÃ³w</li>
                        <li>KanaÅ‚y prywatne</li>
                        <li>Bots i modyfikacje</li>
                        <li>Backupy codzienne</li>
                        <li>SSL Certificate</li>
                    </ul>
                    <button class="btn btn-primary" onclick="buyProduct('teamspeak')">ğŸ›’ Kup Teraz</button>
                </div>
                
                <div class="product-card">
                    <div class="product-icon">ğŸ¯</div>
                    <h3 class="product-title">VPS Game</h3>
                    <div class="product-price">$15/miesiÄ…c</div>
                    <ul class="product-features">
                        <li>2 vCPU Cores</li>
                        <li>4GB RAM</li>
                        <li>50GB SSD</li>
                        <li>1Gbps Port</li>
                        <li>Root dostÄ™p</li>
                    </ul>
                    <button class="btn btn-primary" onclick="buyProduct('vps')">ğŸ›’ Kup Teraz</button>
                </div>
            </div>
        </div>

        <!-- Panel Klienta Info -->
        <div class="client-panel-section">
            <h2 style="color: #6a11cb; margin-bottom: 20px; font-size: 2em;">ğŸ‘¤ Panel Klienta</h2>
            <p style="font-size: 1.2em; margin-bottom: 30px; color: #666;">
                Masz juÅ¼ serwer? PrzejdÅº do panelu klienta aby zarzÄ…dzaÄ‡ swoimi usÅ‚ugami.
            </p>
            <a href="/client" class="btn btn-primary" style="font-size: 1.2em; padding: 15px 40px;">
                ğŸš€ PrzejdÅº do Panelu Klienta
            </a>
        </div>
    </div>

    <div class="footer">
        Copyright Â© 2025 purpleHost.ru - Professional Game Hosting
    </div>

    <script>
        function showSection(section) {
            if (section === 'sklep') {
                document.getElementById('sklep').scrollIntoView({ 
                    behavior: 'smooth' 
                });
            }
        }
        
        function buyProduct(product) {
            alert('ğŸ›’ Dodano do koszyka: ' + product.toUpperCase() + '\n\nPrzejdÅº do panelu klienta aby dokoÅ„czyÄ‡ zakup i aktywowaÄ‡ serwer!');
            // Przekierowanie do panelu klienta
            setTimeout(() => {
                window.location.href = '/client';
            }, 2000);
        }
        
        // Smooth scroll dla linkÃ³w
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });
    </script>
</body>
</html>
HTML

    # Panel Klienta
    mkdir -p "$WEB_DIR/client"
    
    cat > "$WEB_DIR/client/index.html" << 'HTML'
<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ‘¤ Panel Klienta - PurpleHost</title>
    <style>
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body { 
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            padding: 15px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }
        
        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #6a11cb;
        }
        
        .nav-menu {
            display: flex;
            list-style: none;
            gap: 20px;
        }
        
        .nav-menu a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            padding: 8px 16px;
            border-radius: 5px;
            transition: all 0.3s ease;
        }
        
        .nav-menu a:hover, .nav-menu a.active {
            background: #6a11cb;
            color: white;
        }
        
        .container {
            max-width: 1400px;
            margin: 30px auto;
            padding: 0 20px;
        }
        
        .welcome-banner {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .warning-banner {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            color: #856404;
        }
        
        .servers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .server-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            border-left: 4px solid #6a11cb;
        }
        
        .server-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }
        
        .server-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .server-icon {
            font-size: 2em;
        }
        
        .server-status {
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: bold;
        }
        
        .status-online {
            background: #d4edda;
            color: #155724;
        }
        
        .status-offline {
            background: #f8d7da;
            color: #721c24;
        }
        
        .server-info {
            margin-bottom: 15px;
        }
        
        .server-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
            flex: 1;
        }
        
        .btn-primary {
            background: #6a11cb;
            color: white;
        }
        
        .btn-primary:hover {
            background: #5a0db3;
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-danger {
            background: #dc3545;
            color: white;
        }
        
        .create-server-btn {
            background: #28a745;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1.1em;
            margin: 20px 0;
            display: block;
            width: 100%;
            transition: all 0.3s ease;
        }
        
        .create-server-btn:hover {
            background: #218838;
            transform: translateY(-2px);
        }
        
        .server-details {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-top: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .server-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
        }
        
        .tab {
            padding: 12px 25px;
            background: #f8f9fa;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .tab.active {
            background: #6a11cb;
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .console-output {
            background: #1e1e1e;
            color: #00ff00;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            height: 400px;
            overflow-y: auto;
            margin: 15px 0;
        }
        
        .file-manager {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 20px;
            height: 500px;
        }
        
        .file-tree {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            overflow-y: auto;
        }
        
        .file-content {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            overflow-y: auto;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #555;
        }
        
        .form-control {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: white;
            font-size: 0.9em;
        }
        
        .no-servers {
            text-align: center;
            padding: 60px 20px;
            background: white;
            border-radius: 15px;
            margin: 20px 0;
        }
        
        .no-servers .icon {
            font-size: 4em;
            margin-bottom: 20px;
            opacity: 0.5;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="nav-container">
            <div class="logo">ğŸŸ£ PurpleHost - Panel Klienta</div>
            <ul class="nav-menu">
                <li><a href="/">ğŸ  Strona GÅ‚Ã³wna</a></li>
                <li><a href="#" class="active">ğŸ‘¤ Moje Serwery</a></li>
                <li><a href="#">ğŸ“Š Statystyki</a></li>
                <li><a href="#">ğŸ’³ PÅ‚atnoÅ›ci</a></li>
                <li><a href="#">ğŸ« Support</a></li>
            </ul>
        </div>
    </div>

    <div class="container">
        <div class="welcome-banner">
            <h1>ğŸ‘¤ Witaj w Panelu Klienta!</h1>
            <p>ZarzÄ…dzaj swoimi serwerami gry i usÅ‚ugami hostingowymi</p>
        </div>

        <div class="warning-banner">
            âš ï¸ <strong>Warning out...</strong> Not this convention postupancy is a twoism location.
        </div>

        <!-- Przycisk tworzenia serwera -->
        <button class="create-server-btn" onclick="showCreateServerForm()">
            â• UtwÃ³rz Nowy Serwer
        </button>

        <!-- Lista serwerÃ³w -->
        <div id="serversList">
            <div class="no-servers" id="noServersMessage">
                <div class="icon">ğŸ®</div>
                <h2>Brak serwerÃ³w</h2>
                <p>Nie masz jeszcze Å¼adnych serwerÃ³w. UtwÃ³rz pierwszy serwer aby rozpoczÄ…Ä‡!</p>
                <button class="btn btn-primary" onclick="showCreateServerForm()" style="margin-top: 20px;">
                    ğŸš€ UtwÃ³rz Pierwszy Serwer
                </button>
            </div>
            
            <div class="servers-grid" id="serversGrid" style="display: none;">
                <!-- Serwery bÄ™dÄ… dodawane dynamicznie -->
            </div>
        </div>

        <!-- Formularz tworzenia serwera -->
        <div id="createServerForm" class="server-details">
            <h2 style="color: #6a11cb; margin-bottom: 25px;">ğŸ› ï¸ Tworzenie Nowego Serwera</h2>
            
            <div class="form-group">
                <label for="serverName">Nazwa Serwera:</label>
                <input type="text" class="form-control" id="serverName" placeholder="Moja super serwer">
            </div>
            
            <div class="form-group">
                <label for="serverType">Typ Serwera:</label>
                <select class="form-control" id="serverType">
                    <option value="minecraft">â›ï¸ Minecraft</option>
                    <option value="rust">ğŸ¦€ Rust</option>
                    <option value="csgo">ğŸ”« CS:GO</option>
                    <option value="ark">ğŸ¦– ARK: Survival</option>
                    <option value="teamspeak">ğŸ§ TeamSpeak 3</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="serverSlots">Liczba slotÃ³w:</label>
                <select class="form-control" id="serverSlots">
                    <option value="10">10 slotÃ³w</option>
                    <option value="20">20 slotÃ³w</option>
                    <option value="30">30 slotÃ³w</option>
                    <option value="50">50 slotÃ³w</option>
                    <option value="100">100 slotÃ³w</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="serverVersion">Wersja:</label>
                <input type="text" class="form-control" id="serverVersion" placeholder="Najnowsza" value="Najnowsza">
            </div>
            
            <div style="display: flex; gap: 15px; margin-top: 30px;">
                <button class="btn btn-success" onclick="createServer()" style="flex: 2;">ğŸš€ UtwÃ³rz Serwer</button>
                <button class="btn btn-danger" onclick="hideCreateServerForm()" style="flex: 1;">âŒ Anuluj</button>
            </div>
        </div>

        <!-- SzczegÃ³Å‚y serwera -->
        <div id="serverDetails" class="server-details">
            <div style="display: flex; justify-content: between; align-items: center; margin-bottom: 25px;">
                <h2 style="color: #6a11cb; margin: 0;" id="serverDetailsTitle">Serwer Details</h2>
                <button class="btn btn-danger" onclick="hideServerDetails()">âœ–ï¸ Zamknij</button>
            </div>
            
            <div class="server-tabs">
                <button class="tab active" data-tab="console">ğŸ’» Konsola</button>
                <button class="tab" data-tab="files">ğŸ“ Pliki</button>
                <button class="tab" data-tab="node">ğŸ“¦ Node</button>
                <button class="tab" data-tab="settings">âš™ï¸ Ustawienia</button>
                <button class="tab" data-tab="backups">ğŸ’¾ Backupy</button>
            </div>
            
            <!-- Konsola -->
            <div id="console" class="tab-content active">
                <div class="console-output" id="serverConsole">
                    ğŸŸ£ PurpleHost Server Console<br>
                    Serwer: <span id="consoleServerName">Loading...</span><br>
                    Status: <span style="color: #28a745;">Online</span><br>
                    ----------------------------------------<br>
                    WprowadÅº komendy aby zarzÄ…dzaÄ‡ serwerem...
                </div>
                <div style="display: flex; gap: 10px; margin-top: 15px;">
                    <input type="text" class="form-control" id="serverCommand" placeholder="WprowadÅº komendÄ™...">
                    <button class="btn btn-primary" onclick="sendServerCommand()">â–¶ Wykonaj</button>
                </div>
            </div>
            
            <!-- Pliki -->
            <div id="files" class="tab-content">
                <h3 style="margin-bottom: 20px; color: #6a11cb;">ğŸ“ MenedÅ¼er PlikÃ³w</h3>
                <div class="file-manager">
                    <div class="file-tree">
                        <h4>Katalogi Serwera</h4>
                        <div style="margin-top: 15px;">
                            <div>ğŸ“ config/</div>
                            <div>ğŸ“ plugins/</div>
                            <div>ğŸ“ worlds/</div>
                            <div>ğŸ“ logs/</div>
                            <div>ğŸ“„ server.properties</div>
                            <div>ğŸ“„ eula.txt</div>
                        </div>
                    </div>
                    <div class="file-content">
                        <h4>PodglÄ…d Pliku</h4>
                        <p>Wybierz plik z lewej strony aby zobaczyÄ‡ jego zawartoÅ›Ä‡.</p>
                        <div style="margin-top: 20px;">
                            <button class="btn btn-primary">ğŸ“¤ Upload Pliku</button>
                            <button class="btn">ğŸ“¥ Pobierz Backup</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Node -->
            <div id="node" class="tab-content">
                <h3 style="margin-bottom: 20px; color: #6a11cb;">ğŸ“¦ Node.js & Aplikacje</h3>
                <p>ZarzÄ…dzaj aplikacjami Node.js na swoim serwerze.</p>
                <div style="margin-top: 20px;">
                    <button class="btn btn-primary">ğŸš€ Uruchom AplikacjÄ™</button>
                    <button class="btn">ğŸ“Š Statystyki</button>
                    <button class="btn">ğŸ”§ Konfiguracja</button>
                </div>
            </div>
            
            <!-- Ustawienia -->
            <div id="settings" class="tab-content">
                <h3 style="margin-bottom: 20px; color: #6a11cb;">âš™ï¸ Ustawienia Serwera</h3>
                <div class="form-group">
                    <label for="serverPort">Port Serwera:</label>
                    <input type="number" class="form-control" id="serverPort" value="25565">
                </div>
                <div class="form-group">
                    <label for="serverMotd">MOTD (Message of the Day):</label>
                    <input type="text" class="form-control" id="serverMotd" value="PurpleHost Server">
                </div>
                <button class="btn btn-success">ğŸ’¾ Zapisz Ustawienia</button>
            </div>
            
            <!-- Backupy -->
            <div id="backups" class="tab-content">
                <h3 style="margin-bottom: 20px; color: #6a11cb;">ğŸ’¾ System BackupÃ³w</h3>
                <p>ZarzÄ…dzaj kopiami zapasowymi swojego serwera.</p>
                <div style="margin-top: 20px;">
                    <button class="btn btn-success">ğŸ”„ UtwÃ³rz Backup</button>
                    <button class="btn btn-primary">â° Harmonogram</button>
                    <button class="btn">ğŸ“¥ Pobierz Backup</button>
                </div>
            </div>
        </div>
    </div>

    <div class="footer">
        Copyright Â© 2025 purpleHost.ru - Client Panel
    </div>

    <script>
        let servers = JSON.parse(localStorage.getItem('purplehost_servers')) || [];
        let currentServer = null;
        
        // Åadowanie serwerÃ³w
        function loadServers() {
            const serversGrid = document.getElementById('serversGrid');
            const noServersMessage = document.getElementById('noServersMessage');
            
            if (servers.length === 0) {
                serversGrid.style.display = 'none';
                noServersMessage.style.display = 'block';
            } else {
                serversGrid.style.display = 'grid';
                noServersMessage.style.display = 'none';
                
                serversGrid.innerHTML = '';
                servers.forEach(server => {
                    const serverCard = document.createElement('div');
                    serverCard.className = 'server-card';
                    serverCard.innerHTML = `
                        <div class="server-header">
                            <div class="server-icon">${getServerIcon(server.type)}</div>
                            <div class="server-status ${server.status === 'online' ? 'status-online' : 'status-offline'}">
                                ${server.status === 'online' ? 'ğŸŸ¢ ONLINE' : 'ğŸ”´ OFFLINE'}
                            </div>
                        </div>
                        <div class="server-info">
                            <h3 style="color: #6a11cb; margin-bottom: 10px;">${server.name}</h3>
                            <p><strong>Typ:</strong> ${server.type}</p>
                            <p><strong>Sloty:</strong> ${server.slots}</p>
                            <p><strong>Wersja:</strong> ${server.version}</p>
                            <p><strong>Utworzono:</strong> ${server.created}</p>
                        </div>
                        <div class="server-actions">
                            <button class="btn btn-primary" onclick="showServerDetails(${server.id})">
                                ğŸ”§ ZarzÄ…dzaj
                            </button>
                            ${server.status === 'online' ? 
                                '<button class="btn btn-danger" onclick="stopServer(' + server.id + ')">â¹ Stop</button>' : 
                                '<button class="btn btn-success" onclick="startServer(' + server.id + ')">â–¶ Start</button>'
                            }
                        </div>
                    `;
                    serversGrid.appendChild(serverCard);
                });
            }
        }
        
        function getServerIcon(type) {
            const icons = {
                'minecraft': 'â›ï¸',
                'rust': 'ğŸ¦€',
                'csgo': 'ğŸ”«',
                'ark': 'ğŸ¦–',
                'teamspeak': 'ğŸ§'
            };
            return icons[type] || 'ğŸ–¥ï¸';
        }
        
        function showCreateServerForm() {
            document.getElementById('createServerForm').style.display = 'block';
            document.getElementById('serverDetails').style.display = 'none';
        }
        
        function hideCreateServerForm() {
            document.getElementById('createServerForm').style.display = 'none';
        }
        
        function createServer() {
            const name = document.getElementById('serverName').value;
            const type = document.getElementById('serverType').value;
            const slots = document.getElementById('serverSlots').value;
            const version = document.getElementById('serverVersion').value;
            
            if (!name) {
                alert('ProszÄ™ wprowadziÄ‡ nazwÄ™ serwera!');
                return;
            }
            
            const newServer = {
                id: Date.now(),
                name: name,
                type: type,
                slots: slots,
                version: version,
                status: 'offline',
                created: new Date().toLocaleString()
            };
            
            servers.push(newServer);
            localStorage.setItem('purplehost_servers', JSON.stringify(servers));
            
            loadServers();
            hideCreateServerForm();
            
            alert('âœ… Serwer "' + name + '" zostaÅ‚ utworzony pomyÅ›lnie!');
        }
        
        function showServerDetails(serverId) {
            currentServer = servers.find(s => s.id === serverId);
            if (!currentServer) return;
            
            document.getElementById('serverDetailsTitle').textContent = 'Serwer: ' + currentServer.name;
            document.getElementById('consoleServerName').textContent = currentServer.name;
            document.getElementById('serverDetails').style.display = 'block';
            document.getElementById('createServerForm').style.display = 'none';
            
            // Reset tabs
            showTab('console');
        }
        
        function hideServerDetails() {
            document.getElementById('serverDetails').style.display = 'none';
        }
        
        function showTab(tabName) {
            // Ukryj wszystkie taby
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // PokaÅ¼ wybrany tab
            document.getElementById(tabName).classList.add('active');
            document.querySelector(`.tab[data-tab="${tabName}"]`).classList.add('active');
        }
        
        function startServer(serverId) {
            const server = servers.find(s => s.id === serverId);
            if (server) {
                server.status = 'online';
                localStorage.setItem('purplehost_servers', JSON.stringify(servers));
                loadServers();
                alert('ğŸŸ¢ Serwer "' + server.name + '" uruchomiony!');
            }
        }
        
        function stopServer(serverId) {
            const server = servers.find(s => s.id === serverId);
            if (server) {
                server.status = 'offline';
                localStorage.setItem('purplehost_servers', JSON.stringify(servers));
                loadServers();
                alert('ğŸ”´ Serwer "' + server.name + '" zatrzymany!');
            }
        }
        
        function sendServerCommand() {
            const command = document.getElementById('serverCommand').value;
            const console = document.getElementById('serverConsole');
            
            if (command.trim() === '') return;
            
            console.innerHTML += `<div><strong>$ ${command}</strong></div>`;
            console.innerHTML += `<div>Command executed successfully</div>`;
            console.scrollTop = console.scrollHeight;
            
            document.getElementById('serverCommand').value = '';
        }
        
        // Inicjalizacja
        document.addEventListener('DOMContentLoaded', function() {
            loadServers();
            
            // ObsÅ‚uga tabÃ³w
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    showTab(tabName);
                });
            });
            
            // Enter w konsoli
            document.getElementById('serverCommand').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendServerCommand();
                }
            });
        });
    </script>
</body>
</html>
HTML

    echo -e "${GREEN}âœ… Strona gÅ‚Ã³wna PurpleHost ze sklepem i panelem klienta zostaÅ‚a utworzona!${NC}"
    echo -e "${PURPLE}ğŸ“ Strona gÅ‚Ã³wna: $WEB_DIR/index.html${NC}"
    echo -e "${PURPLE}ğŸ‘¤ Panel klienta: $WEB_DIR/client/index.html${NC}"
}

start_web_server() {
    echo -e "${PURPLE}ğŸŒ Uruchamianie serwera PurpleHost...${NC}"
    
    # SprawdÅº czy port jest dostÄ™pny
    if lsof -Pi :$PORT -sTCP:LISTEN -t >/dev/null ; then
        echo -e "${YELLOW}ğŸ”„ Port $PORT jest zajÄ™ty, zatrzymywanie istniejÄ…cego serwera...${NC}"
        pkill -f "python3 -m http.server $PORT"
        sleep 2
    fi
    
    # Uruchom serwer HTTP
    cd "$WEB_DIR"
    python3 -m http.server $PORT > /dev/null 2>&1 &
    local web_pid=$!
    
    sleep 2
    
    if ps -p $web_pid > /dev/null 2>&1; then
        local ip=$(hostname -I | awk '{print $1}')
        
        echo -e "${GREEN}âœ… Serwer PurpleHost uruchomiony pomyÅ›lnie!${NC}"
        echo -e "${PURPLE}"
        echo -e "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
        echo -e "â•‘                      ğŸŸ£ PURPLEHOST                        â•‘"
        echo -e "â•‘                 SKLEP + PANEL KLIENTA                     â•‘"
        echo -e "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
        echo -e "â•‘                                                            â•‘"
        echo -e "â•‘  ğŸŒ Adresy dostÄ™pu:                                        â•‘"
        echo -e "â•‘     ğŸ“ Strona GÅ‚Ã³wna:  http://localhost:$PORT             â•‘"
        echo -e "â•‘     ğŸ‘¤ Panel Klienta: http://localhost:$PORT/client       â•‘"
        echo -e "â•‘     ğŸŒ SieÄ‡:          http://$ip:$PORT                    â•‘"
        echo -e "â•‘                                                            â•‘"
        echo -e "â•‘  ğŸ¯ FunkcjonalnoÅ›ci:                                       â•‘"
        echo -e "â•‘     â€¢ ğŸ›’ Sklep z serwerami gry                            â•‘"
        echo -e "â•‘     â€¢ ğŸ‘¤ Panel klienta z zarzÄ…dzaniem                     â•‘"
        echo -e "â•‘     â€¢ ğŸ® Tworzenie i konfiguracja serwerÃ³w                â•‘"
        echo -e "â•‘     â€¢ ğŸ’» Konsola, ğŸ“ Pliki, ğŸ“¦ Node, âš™ï¸ Ustawienia       â•‘"
        echo -e "â•‘                                                            â•‘"
        echo -e "â•‘  ğŸ’¡ OtwÃ³rz przeglÄ…darkÄ™ i rozpocznij korzystanie!         â•‘"
        echo -e "â•‘                                                            â•‘"
        echo -e "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
        echo -e "${NC}"
        
        # OtwÃ³rz przeglÄ…darkÄ™ jeÅ›li jest graficzne Å›rodowisko
        if [ -n "$DISPLAY" ]; then
            echo -e "${YELLOW}ğŸ–¥ï¸  Otwieranie przeglÄ…darki...${NC}"
            xdg-open "http://localhost:$PORT" 2>/dev/null &
        fi
        
        # Zapisz PID serwera
        echo $web_pid > "$PANEL_DIR/web_server.pid"
        log "Serwer web uruchomiony (PID: $web_pid)"
        
    else
        error "âŒ Nie udaÅ‚o siÄ™ uruchomiÄ‡ serwera web!"
        exit 1
    fi
}

# =============================================
# ğŸ“œ MAIN SCRIPT - AUTOMATYCZNA INSTALACJA
# =============================================

clear

echo -e "${PURPLE}"
echo -e "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo -e "â•‘        ğŸŸ£ PURPLEHOST v3.0            â•‘"
echo -e "â•‘      Sklep + Panel Klienta           â•‘"
echo -e "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo -e "${NC}"
echo -e "${CYAN}Rozpoczynanie automatycznej instalacji...${NC}"
echo ""

# Inicjalizacja
echo -e "${PURPLE}ğŸš€ Inicjalizacja systemu...${NC}"
setup_directories
check_dependencies

# Tworzenie panelu
echo -e "${PURPLE}ğŸ“ Tworzenie sklepu i panelu klienta...${NC}"
create_web_panel

# Uruchamianie serwera
echo -e "${PURPLE}ğŸŒ Uruchamianie serwera...${NC}"
start_web_server

# Komunikat sukcesu
echo -e "${GREEN}"
echo -e "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo -e "â•‘                    ğŸ‰ SYSTEM GOTOWY!                      â•‘"
echo -e "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
echo -e "â•‘                                                            â•‘"
echo -e "â•‘  PurpleHost zostaÅ‚ uruchomiony z dwoma gÅ‚Ã³wnymi sekcjami:  â•‘"
echo -e "â•‘                                                            â•‘"
echo -e "â•‘  1. ğŸ›’ STRONA GÅÃ“WNA - SKLEP                               â•‘"
echo -e "â•‘     â€¢ PrzeglÄ…daj ofertÄ™ serwerÃ³w                          â•‘"
echo -e "â•‘     â€¢ Wybierz i kup swÃ³j serwer                           â•‘"
echo -e "â•‘     â€¢ PrzejdÅº do panelu klienta                           â•‘"
echo -e "â•‘                                                            â•‘"
echo -e "â•‘  2. ğŸ‘¤ PANEL KLIENTA                                      â•‘"
echo -e "â•‘     â€¢ TwÃ³rz nowe serwery                                  â•‘"
echo -e "â•‘     â€¢ ZarzÄ…dzaj istniejÄ…cymi serwerami                    â•‘"
echo -e "â•‘     â€¢ ğŸ’» Konsola - dostÄ™p do systemu                      â•‘"
echo -e "â•‘     â€¢ ğŸ“ Pliki - menedÅ¼er plikÃ³w                         â•‘"
echo -e "â•‘     â€¢ ğŸ“¦ Node - aplikacje Node.js                        â•‘"
echo -e "â•‘     â€¢ âš™ï¸ Ustawienia - konfiguracja                       â•‘"
echo -e "â•‘     â€¢ ğŸ’¾ Backupy - kopie zapasowe                        â•‘"
echo -e "â•‘                                                            â•‘"
echo -e "â•‘  WejdÅº na http://localhost:8080 aby zobaczyÄ‡ sklep!       â•‘"
echo -e "â•‘  Lub bezpoÅ›rednio do panelu: http://localhost:8080/client â•‘"
echo -e "â•‘                                                            â•‘"
echo -e "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo -e "${NC}"

echo -e "${YELLOW}ğŸ“ Aby zatrzymaÄ‡ panel, naciÅ›nij Ctrl+C${NC}"
echo ""

# Czekaj na sygnaÅ‚ zakoÅ„czenia
trap 'echo -e "\n${GREEN}ğŸ‘‹ Zamykanie PurpleHost...${NC}"; pkill -f "python3 -m http.server $PORT"; exit 0' INT TERM

# Bezczynne czekanie
while true; do
    sleep 60
done
